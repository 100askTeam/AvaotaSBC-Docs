"use strict";(self.webpackChunkavaota_docs=self.webpackChunkavaota_docs||[]).push([[3181],{44597:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>_,default:()=>u,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var i=r(85893),s=r(11151);const l={},_="UART \u9a71\u52a8",a={id:"linux-manual/syterkit/driver/uart",title:"UART \u9a71\u52a8",description:"\u7ed3\u6784\u4f53",source:"@site/docs/linux-manual/syterkit/driver/uart.md",sourceDirName:"linux-manual/syterkit/driver",slug:"/linux-manual/syterkit/driver/uart",permalink:"/en-US/linux-manual/syterkit/driver/uart",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"linuxManualSidebar",previous:{title:"SPI \u9a71\u52a8",permalink:"/en-US/linux-manual/syterkit/driver/spi"},next:{title:"AMP \u5f02\u6784\u8ba1\u7b97",permalink:"/en-US/category/amp-\u5f02\u6784\u8ba1\u7b97"}},d={},c=[{value:"\u7ed3\u6784\u4f53",id:"\u7ed3\u6784\u4f53",level:2},{value:"API \u63a5\u53e3",id:"api-\u63a5\u53e3",level:2},{value:"sunxi_serial_init",id:"sunxi_serial_init",level:3},{value:"sunxi_serial_putc",id:"sunxi_serial_putc",level:3},{value:"sunxi_serial_tstc",id:"sunxi_serial_tstc",level:3},{value:"sunxi_serial_getc",id:"sunxi_serial_getc",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:2},{value:"\u7b80\u6613\u6a21\u5f0f",id:"\u7b80\u6613\u6a21\u5f0f",level:3},{value:"\u4e13\u4e1a\u6a21\u5f0f",id:"\u4e13\u4e1a\u6a21\u5f0f",level:3}];function t(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"uart-\u9a71\u52a8",children:"UART \u9a71\u52a8"}),"\n",(0,i.jsx)(e.h2,{id:"\u7ed3\u6784\u4f53",children:"\u7ed3\u6784\u4f53"}),"\n",(0,i.jsx)(e.p,{children:"\u6ce2\u7279\u7387\u5b9a\u4e49\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\r\n    UART_BAUDRATE_300 = 300,\r\n    UART_BAUDRATE_600 = 600,\r\n    UART_BAUDRATE_1200 = 1200,\r\n    UART_BAUDRATE_2400 = 2400,\r\n    UART_BAUDRATE_4800 = 4800,\r\n    UART_BAUDRATE_9600 = 9600,\r\n    UART_BAUDRATE_19200 = 19200,\r\n    UART_BAUDRATE_38400 = 38400,\r\n    UART_BAUDRATE_57600 = 57600,\r\n    UART_BAUDRATE_115200 = 115200,\r\n    UART_BAUDRATE_230400 = 230400,\r\n    UART_BAUDRATE_460800 = 460800,\r\n    UART_BAUDRATE_921600 = 921600,\r\n    UART_BAUDRATE_1500000 = 1500000,\r\n    UART_BAUDRATE_MAX,\r\n} sunxi_serial_baudrate_t;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6821\u9a8c\u4f4d\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\r\n    UART_PARITY_NO = 0,\r\n    UART_PARITY_ODD,\r\n    UART_PARITY_EVEN,\r\n} sunxi_serial_parity_t;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u505c\u6b62\u4f4d\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\r\n    UART_STOP_BIT_0 = 0,\r\n    UART_STOP_BIT_1,\r\n} sunxi_serial_stop_bit_t;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u957f\u5ea6\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\r\n    UART_DLEN_5 = 0,\r\n    UART_DLEN_6,\r\n    UART_DLEN_7,\r\n    UART_DLEN_8,\r\n} sunxi_serial_dlen_t;\n"})}),"\n",(0,i.jsx)(e.p,{children:"UART \u8bbe\u5907\u63cf\u8ff0\u7ed3\u6784\u4f53"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef struct {\r\n    uint32_t base;                     /* Base address of the serial device */\r\n    uint8_t id;                        /* ID of the serial device */\r\n    sunxi_serial_baudrate_t baud_rate; /* Baud rate configuration */\r\n    sunxi_serial_parity_t parity;      /* Parity configuration */\r\n    sunxi_serial_stop_bit_t stop;      /* Stop bit configuration */\r\n    sunxi_serial_dlen_t dlen;          /* Data length configuration */\r\n    gpio_mux_t gpio_tx;                /* GPIO pin for data transmission */\r\n    gpio_mux_t gpio_rx;                /* GPIO pin for data reception */\r\n} sunxi_serial_t;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"api-\u63a5\u53e3",children:"API \u63a5\u53e3"}),"\n",(0,i.jsx)(e.h3,{id:"sunxi_serial_init",children:"sunxi_serial_init"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"void sunxi_serial_init(sunxi_serial_t *uart);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63cf\u8ff0\uff1a\u4f7f\u7528\u6307\u5b9a\u7684\u914d\u7f6e\u521d\u59cb\u5316 Sunxi \u4e32\u53e3\u63a5\u53e3\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"uart"}),"\uff1a\u6307\u5411 Sunxi \u4e32\u53e3\u63a5\u53e3\u7ed3\u6784\u7684\u6307\u9488\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"sunxi_serial_putc",children:"sunxi_serial_putc"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"void sunxi_serial_putc(void *arg, char c);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63cf\u8ff0\uff1a\u901a\u8fc7 Sunxi \u4e32\u53e3\u63a5\u53e3\u53d1\u9001\u4e00\u4e2a\u5b57\u7b26\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"arg"}),"\uff1a\u6307\u5411 Sunxi \u4e32\u53e3\u63a5\u53e3\u53c2\u6570\u7684\u6307\u9488\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"c"}),"\uff1a\u8981\u53d1\u9001\u7684\u5b57\u7b26\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"sunxi_serial_tstc",children:"sunxi_serial_tstc"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"int sunxi_serial_tstc(void *arg);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63cf\u8ff0\uff1a\u68c0\u67e5 Sunxi \u4e32\u53e3\u63a5\u53e3\u662f\u5426\u6709\u53ef\u8bfb\u53d6\u7684\u5b57\u7b26\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"arg"}),"\uff1a\u6307\u5411 Sunxi \u4e32\u53e3\u63a5\u53e3\u53c2\u6570\u7684\u6307\u9488\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u8fd4\u56de\u503c\uff1a\u5982\u679c\u6709\u53ef\u7528\u5b57\u7b26\u5219\u8fd4\u56de1\uff0c\u5426\u5219\u8fd4\u56de0\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"sunxi_serial_getc",children:"sunxi_serial_getc"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"char sunxi_serial_getc(void *arg);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63cf\u8ff0\uff1a\u4ece Sunxi \u4e32\u53e3\u63a5\u53e3\u8bfb\u53d6\u4e00\u4e2a\u5b57\u7b26\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u53c2\u6570\uff1a","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"arg"}),"\uff1a\u6307\u5411 Sunxi \u4e32\u53e3\u63a5\u53e3\u53c2\u6570\u7684\u6307\u9488\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u8fd4\u56de\u503c\uff1a\u4ece\u63a5\u53e3\u8bfb\u53d6\u7684\u5b57\u7b26\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(e.h3,{id:"\u7b80\u6613\u6a21\u5f0f",children:"\u7b80\u6613\u6a21\u5f0f"}),"\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u4e32\u53e3 0 \u4e3a ",(0,i.jsx)(e.code,{children:"115200-8-1"}),"\uff0c\u5f15\u811a ",(0,i.jsx)(e.code,{children:"PB9"})," ",(0,i.jsx)(e.code,{children:"PB10"}),"\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"sunxi_serial_t uart_dbg = {\r\n    .base = SUNXI_UART0_BASE,\r\n    .id = 0,\r\n    .gpio_tx = {GPIO_PIN(GPIO_PORTB, 9), GPIO_PERIPH_MUX2},\r\n    .gpio_rx = {GPIO_PIN(GPIO_PORTB, 10), GPIO_PERIPH_MUX2},\r\n};\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'#include <stdbool.h>\r\n#include <stddef.h>\r\n#include <stdint.h>\r\n#include <types.h>\r\n#include <log.h>\r\n#include <common.h>\r\n\r\nsunxi_serial_t uart_dbg = {\r\n    .base = SUNXI_UART0_BASE,\r\n    .id = 0,\r\n    .gpio_tx = {GPIO_PIN(GPIO_PORTB, 9), GPIO_PERIPH_MUX2},\r\n    .gpio_rx = {GPIO_PIN(GPIO_PORTB, 10), GPIO_PERIPH_MUX2},\r\n};\r\n\r\nint main(void) {\r\n    sunxi_serial_init(&uart_dbg);\r\n    printk_info("Hello World!\\n");\r\n    abort();\r\n    return 0;\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u4e13\u4e1a\u6a21\u5f0f",children:"\u4e13\u4e1a\u6a21\u5f0f"}),"\n",(0,i.jsxs)(e.p,{children:["\u914d\u7f6e\u4e32\u53e3 0 \u4e3a ",(0,i.jsx)(e.code,{children:"1500000-8-1"}),"\uff0c\u5f15\u811a ",(0,i.jsx)(e.code,{children:"PB9"})," ",(0,i.jsx)(e.code,{children:"PB10"}),"\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"sunxi_serial_t uart_dbg_1m5 = {\r\n    .base = SUNXI_UART0_BASE,\r\n    .id = 0,\r\n    .baud_rate = UART_BAUDRATE_1500000,\r\n    .dlen = UART_DLEN_8,\r\n    .stop = UART_STOP_BIT_0,\r\n    .parity = UART_PARITY_NO,\r\n    .gpio_tx = {GPIO_PIN(GPIO_PORTB, 9), GPIO_PERIPH_MUX2},\r\n    .gpio_rx = {GPIO_PIN(GPIO_PORTB, 10), GPIO_PERIPH_MUX2},\r\n};\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'#include <stdbool.h>\r\n#include <stddef.h>\r\n#include <stdint.h>\r\n#include <types.h>\r\n#include <log.h>\r\n#include <common.h>\r\n\r\nsunxi_serial_t uart_dbg_1m5 = {\r\n    .base = SUNXI_UART0_BASE,\r\n    .id = 0,\r\n    .baud_rate = UART_BAUDRATE_1500000,\r\n    .dlen = UART_DLEN_8,\r\n    .stop = UART_STOP_BIT_0,\r\n    .parity = UART_PARITY_NO,\r\n    .gpio_tx = {GPIO_PIN(GPIO_PORTB, 9), GPIO_PERIPH_MUX2},\r\n    .gpio_rx = {GPIO_PIN(GPIO_PORTB, 10), GPIO_PERIPH_MUX2},\r\n};\r\n\r\nint main(void) {\r\n    sunxi_serial_init(&uart_dbg_1m5);\r\n    printk_info("Hello World!\\n");\r\n    abort();\r\n    return 0;\r\n}\n'})})]})}function u(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(t,{...n})}):t(n)}},11151:(n,e,r)=>{r.d(e,{Z:()=>a,a:()=>_});var i=r(67294);const s={},l=i.createContext(s);function _(n){const e=i.useContext(l);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:_(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);