"use strict";(self.webpackChunkavaota_docs=self.webpackChunkavaota_docs||[]).push([[3812],{96502:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>t,contentTitle:()=>d,default:()=>j,frontMatter:()=>l,metadata:()=>c,toc:()=>x});var s=i(85893),r=i(11151);const l={},d="TWI - Two Wire Interface",c={id:"linux-manual/sdk-develop/bsp-driver/twi",title:"TWI - Two Wire Interface",description:"TWI \u603b\u7ebf\u517c\u5bb9 I2C \u603b\u7ebf\u534f\u8bae\uff0c\u662f\u4e00\u79cd\u7b80\u5355\u3001\u53cc\u5411\u4e8c\u7ebf\u5236\u540c\u6b65\u4e32\u884c\u603b\u7ebf\u3002\u5b83\u53ea\u9700\u8981\u4e24\u6839\u7ebf\u5373\u53ef\u5728\u8fde\u63a5\u4e8e\u603b\u7ebf\u4e0a\u7684\u5668\u4ef6\u4e4b\u95f4\u4f20\u9001\u4fe1\u606f\u3002 TWI\u63a7\u5236\u5668\u652f\u6301\u7684\u6807\u51c6\u901a\u4fe1\u901f\u7387\u4e3a100kbps\uff0c\u6700\u9ad8\u901a\u4fe1\u901f\u7387\u53ef\u4ee5\u8fbe\u5230400kbps\u3002\u5168\u5fd7\u7684twi\u63a7\u5236\u5668\u652f\u6301\u4ee5\u4e0b\u529f\u80fd\uff1a",source:"@site/docs/linux-manual/sdk-develop/bsp-driver/twi.md",sourceDirName:"linux-manual/sdk-develop/bsp-driver",slug:"/linux-manual/sdk-develop/bsp-driver/twi",permalink:"/en-US/linux-manual/sdk-develop/bsp-driver/twi",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"linuxManualSidebar",previous:{title:"Timer - \u5b9a\u65f6\u5668",permalink:"/en-US/linux-manual/sdk-develop/bsp-driver/timer"},next:{title:"UART - \u901a\u7528\u5f02\u6b65\u6536\u53d1\u4f20\u8f93\u5668",permalink:"/en-US/linux-manual/sdk-develop/bsp-driver/uart"}},t={},x=[{value:"\u6a21\u5757\u914d\u7f6e",id:"\u6a21\u5757\u914d\u7f6e",level:2},{value:"\u9a71\u52a8\u914d\u7f6e",id:"\u9a71\u52a8\u914d\u7f6e",level:3},{value:"\u8bbe\u5907\u6811\u914d\u7f6e",id:"\u8bbe\u5907\u6811\u914d\u7f6e",level:3},{value:"\u5f15\u811a\u914d\u7f6e",id:"\u5f15\u811a\u914d\u7f6e",level:4},{value:"TWI \u63a7\u5236\u5668\u914d\u7f6e",id:"twi-\u63a7\u5236\u5668\u914d\u7f6e",level:4},{value:"\u677f\u7ea7\u914d\u7f6e",id:"\u677f\u7ea7\u914d\u7f6e",level:3},{value:"\u5de5\u4f5c\u6a21\u5f0f",id:"\u5de5\u4f5c\u6a21\u5f0f",level:2},{value:"master \u6a21\u5f0f",id:"master-\u6a21\u5f0f",level:3},{value:"engine \u6a21\u5f0f\u914d\u7f6e",id:"engine-\u6a21\u5f0f\u914d\u7f6e",level:3},{value:"drv \u6a21\u5f0f\u914d\u7f6e",id:"drv-\u6a21\u5f0f\u914d\u7f6e",level:3},{value:"\u4f20\u8f93\u901f\u7387\u914d\u7f6e",id:"\u4f20\u8f93\u901f\u7387\u914d\u7f6e",level:3},{value:"slave \u6a21\u5f0f",id:"slave-\u6a21\u5f0f",level:3},{value:"\u5185\u6838\u9a71\u52a8\u914d\u7f6e",id:"\u5185\u6838\u9a71\u52a8\u914d\u7f6e",level:4},{value:"\u6a21\u5757\u4ecb\u7ecd",id:"\u6a21\u5757\u4ecb\u7ecd",level:2},{value:"\u6a21\u5757\u521d\u59cb\u5316\u6d41\u7a0b",id:"\u6a21\u5757\u521d\u59cb\u5316\u6d41\u7a0b",level:3},{value:"\u6a21\u5757\u6570\u636e\u53d1\u9001\u6d41\u7a0b",id:"\u6a21\u5757\u6570\u636e\u53d1\u9001\u6d41\u7a0b",level:3},{value:"\u6a21\u5757 Delay Init \u5904\u7406\u6d41\u7a0b",id:"\u6a21\u5757-delay-init-\u5904\u7406\u6d41\u7a0b",level:3},{value:"\u4f11\u7720\u5524\u9192\u5904\u7406\u6d41\u7a0b",id:"\u4f11\u7720\u5524\u9192\u5904\u7406\u6d41\u7a0b",level:3},{value:"\u5173\u673a\u6d41\u7a0b",id:"\u5173\u673a\u6d41\u7a0b",level:3},{value:"\u6a21\u5757\u5185\u90e8\u63a5\u53e3",id:"\u6a21\u5757\u5185\u90e8\u63a5\u53e3",level:3},{value:"I2C CORE \u63a5\u53e3",id:"i2c-core-\u63a5\u53e3",level:3},{value:"I2C \u7528\u6237\u6001\u63a5\u53e3",id:"i2c-\u7528\u6237\u6001\u63a5\u53e3",level:3},{value:"\u4f7f\u7528\u8303\u4f8b",id:"\u4f7f\u7528\u8303\u4f8b",level:2},{value:"\u5185\u6838\u6001",id:"\u5185\u6838\u6001",level:3},{value:"\u7528\u6237\u6001",id:"\u7528\u6237\u6001",level:3},{value:"FAQ",id:"faq",level:2},{value:"TWI\u6570\u636e\u672a\u5b8c\u5168\u53d1\u9001",id:"twi\u6570\u636e\u672a\u5b8c\u5168\u53d1\u9001",level:3},{value:"TWI\u8d77\u59cb\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",id:"twi\u8d77\u59cb\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",level:3},{value:"TWI\u7ec8\u6b62\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",id:"twi\u7ec8\u6b62\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",level:3},{value:"TWI\u4f20\u9001\u8d85\u65f6",id:"twi\u4f20\u9001\u8d85\u65f6",level:3}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"twi---two-wire-interface",children:"TWI - Two Wire Interface"}),"\n",(0,s.jsx)(e.p,{children:"TWI \u603b\u7ebf\u517c\u5bb9 I2C \u603b\u7ebf\u534f\u8bae\uff0c\u662f\u4e00\u79cd\u7b80\u5355\u3001\u53cc\u5411\u4e8c\u7ebf\u5236\u540c\u6b65\u4e32\u884c\u603b\u7ebf\u3002\u5b83\u53ea\u9700\u8981\u4e24\u6839\u7ebf\u5373\u53ef\u5728\u8fde\u63a5\u4e8e\u603b\u7ebf\u4e0a\u7684\u5668\u4ef6\u4e4b\u95f4\u4f20\u9001\u4fe1\u606f\u3002 TWI\u63a7\u5236\u5668\u652f\u6301\u7684\u6807\u51c6\u901a\u4fe1\u901f\u7387\u4e3a100kbps\uff0c\u6700\u9ad8\u901a\u4fe1\u901f\u7387\u53ef\u4ee5\u8fbe\u5230400kbps\u3002\u5168\u5fd7\u7684twi\u63a7\u5236\u5668\u652f\u6301\u4ee5\u4e0b\u529f\u80fd\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u652f\u6301\u4e3b\u673a\u6a21\u5f0f\u548c\u4ece\u673a\u6a21\u5f0f\uff1b","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4e3b\u673a\u6a21\u5f0f\u4e0b\u652f\u6301dma\u4f20\u8f93\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u4e3b\u673a\u6a21\u5f0f\u4e0b\u5728\u591a\u4e2a\u4e3b\u673a\u7684\u6a21\u5f0f\u4e0b\u652f\u6301\u603b\u7ebf\u4ef2\u88c1\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u4e3b\u673a\u6a21\u5f0f\u4e0b\u652f\u6301\u65f6\u949f\u540c\u6b65\uff0c\u4f4d\u548c\u5b57\u8282\u7b49\u5f85\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u4ece\u673a\u6a21\u5f0f\u4e0b\u652f\u6301\u5730\u5740\u68c0\u6d4b\u4e2d\u65ad\uff1b"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"\u652f\u63017bit\u4ece\u673a\u5730\u5740\u548c10bit\u4ece\u673a\u5730\u5740\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u652f\u6301\u5e38\u89c4\u7684 I2C \u534f\u8bae\u6a21\u5f0f\u548c\u81ea\u5b9a\u4e49\u4f20\u8f93\u6a21\u5f0f\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u6a21\u5757\u914d\u7f6e",children:"\u6a21\u5757\u914d\u7f6e"}),"\n",(0,s.jsx)(e.h3,{id:"\u9a71\u52a8\u914d\u7f6e",children:"\u9a71\u52a8\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"TWI Drivers ->\r\n\t<*> I2C Support for Allwinner SoCs\r\n\t[ ]   SUNXI TWI hardware init delay\r\n\t[ ]   SUNXI TWI DYNAMIC DEBUG\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20240514121248384",src:i(46992).Z+"",width:"1076",height:"257"})}),"\n",(0,s.jsx)(e.h3,{id:"\u8bbe\u5907\u6811\u914d\u7f6e",children:"\u8bbe\u5907\u6811\u914d\u7f6e"}),"\n",(0,s.jsx)(e.h4,{id:"\u5f15\u811a\u914d\u7f6e",children:"\u5f15\u811a\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&pio {\r\n\ttwi0_pins_default: twi0@0 {\r\n        pins = "PD22", "PD23";\r\n        function = "twi0";\r\n        drive-strength = <10>;\r\n        bias-pull-up;\r\n    };\r\n\r\n    twi0_pins_sleep: twi0@1 {\r\n        pins = "PD22", "PD23";\r\n        function = "gpio_in";\r\n    };\r\n};\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u90e8\u5206\u5e73\u53f0\u5b58\u5728\u4e24\u4e2a\u57df\uff0c\u9700\u8981\u5206\u5f00\u914d\u7f6e\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&r_pio {\r\n\ts_twi0_pins_default: s_twi0@0 {\r\n\t\tpins = "PL0", "PL1";\r\n\t\tfunction = "s_twi0";\r\n\t\tdrive-strength = <10>;\r\n\t\tbias-pull-up;\r\n\t};\r\n\r\n\ts_twi0_pins_sleep: s_twi0@1 {\r\n\t\tpins = "PL0", "PL1";\r\n\t\tfunction = "gpio_in";\r\n\t};\r\n};\n'})}),"\n",(0,s.jsx)(e.h4,{id:"twi-\u63a7\u5236\u5668\u914d\u7f6e",children:"TWI \u63a7\u5236\u5668\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'twi0: twi0@2502000 {\r\n    #address-cells = <1>;\r\n    #size-cells = \u5c0f\u4e8e0>;\r\n    compatible = "allwinner,sunxi-twi-v101";\r\n    device_type = "twi0";\r\n    reg = \u5c0f\u4e8e0x0 0x02502000 0x0 0x400>;\r\n    interrupts = <GIC_SPI 10 IRQ_TYPE_LEVEL_HIGH>;\r\n    clocks = <&ccu CLK_TWI0>;\r\n    clock-names = "bus";\r\n    resets = <&ccu RST_BUS_TWI0>;\r\n    dmas = <&dma 43>, <&dma 43>;\r\n    dma-names = "tx", "rx";\r\n    status = "okay";\r\n};\n'})}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"twi0: twi0@2502000 {"}),"\uff1a\u8bbe\u5907\u8282\u70b9\u540d\u79f0\uff0c",(0,s.jsx)(e.code,{children:"twi0"}),"\u662f\u8bbe\u5907\u7684\u522b\u540d\uff0c",(0,s.jsx)(e.code,{children:"@2502000"}),"\u662f\u8bbe\u5907\u5728\u5185\u5b58\u4e2d\u7684\u57fa\u5730\u5740\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"#address-cells = <1>;"}),"\uff1a\u5b9a\u4e49\u8bbe\u5907\u5730\u5740\u5355\u5143\u7684\u6570\u91cf\u3002\u8fd9\u91cc\u662f1\uff0c\u8868\u793a\u6bcf\u4e2a\u8bbe\u5907\u5730\u5740\u4f7f\u7528\u4e00\u4e2a\u5355\u5143\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"#size-cells = \u5c0f\u4e8e0>;"}),"\uff1a\u5b9a\u4e49\u8bbe\u5907\u5927\u5c0f\u5355\u5143\u7684\u6570\u91cf\u3002\u8fd9\u91cc\u662f0\uff0c\u8868\u793a\u8bbe\u5907\u5927\u5c0f\u4e0d\u9002\u7528\u6216\u4e3a\u56fa\u5b9a\u5927\u5c0f\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'compatible = "allwinner,sunxi-twi-v101";'}),"\uff1a\u8bbe\u5907\u517c\u5bb9\u6027\u63cf\u8ff0\uff0c\u6307\u5b9a\u4e86\u8bbe\u5907\u4e0e\u9a71\u52a8\u7a0b\u5e8f\u7684\u517c\u5bb9\u6027\u3002",(0,s.jsx)(e.code,{children:"allwinner,sunxi-twi-v101"}),"\u8868\u793a\u8be5\u8bbe\u5907\u517c\u5bb9Allwinner\u7684Sunxi TWI\u7248\u672c101\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'device_type = "twi0";'}),"\uff1a\u8bbe\u5907\u7c7b\u578b\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2aTWI\u8bbe\u5907\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"reg = \u5c0f\u4e8e0x0 0x02502000 0x0 0x400>;"}),"\uff1a\u8bbe\u5907\u7684\u5bc4\u5b58\u5668\u5730\u5740\u548c\u5927\u5c0f\u63cf\u8ff0\u3002",(0,s.jsx)(e.code,{children:"\u5c0f\u4e8e0x0 0x02502000 0x0 0x400>"}),"\u6307\u5b9a\u4e86\u8bbe\u5907\u7684\u5bc4\u5b58\u5668\u5730\u5740\u8303\u56f4\uff0c\u4ece0x02502000\u52300x025023FF\uff0c\u5927\u5c0f\u4e3a0x400\u5b57\u8282\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"interrupts = <GIC_SPI 10 IRQ_TYPE_LEVEL_HIGH>;"}),"\uff1a\u8bbe\u5907\u4e2d\u65ad\u63cf\u8ff0\uff0c\u6307\u5b9a\u4e86\u8bbe\u5907\u4f7f\u7528\u7684\u4e2d\u65ad\u63a7\u5236\u5668\u548c\u4e2d\u65ad\u53f7\uff0c\u4ee5\u53ca\u4e2d\u65ad\u89e6\u53d1\u7c7b\u578b\u3002\u8fd9\u91cc\u4f7f\u7528\u4e86GIC\uff08Generic Interrupt Controller\uff09\u4f5c\u4e3a\u4e2d\u65ad\u63a7\u5236\u5668\uff0c\u4e2d\u65ad\u53f7\u4e3a10\uff0c\u89e6\u53d1\u7c7b\u578b\u4e3a\u9ad8\u7535\u5e73\u89e6\u53d1\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"clocks = <&ccu CLK_TWI0>;"}),"\uff1a\u8bbe\u5907\u65f6\u949f\u63cf\u8ff0\uff0c\u6307\u5b9a\u4e86\u8bbe\u5907\u4f7f\u7528\u7684\u65f6\u949f\u6e90\u3002",(0,s.jsx)(e.code,{children:"<&ccu CLK_TWI0>"}),"\u8868\u793a\u8bbe\u5907\u4f7f\u7528\u4e86CCU\uff08Clock Control Unit\uff09\u4e2d\u7684",(0,s.jsx)(e.code,{children:"CLK_TWI0"}),"\u65f6\u949f\u6e90\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'clock-names = "bus";'}),'\uff1a\u8bbe\u5907\u65f6\u949f\u540d\u79f0\uff0c\u6307\u5b9a\u4e86\u65f6\u949f\u7684\u529f\u80fd\u540d\u79f0\uff0c\u8fd9\u91cc\u662f"bus"\u3002']}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"resets = <&ccu RST_BUS_TWI0>;"}),"\uff1a\u8bbe\u5907\u590d\u4f4d\u63cf\u8ff0\uff0c\u6307\u5b9a\u4e86\u8bbe\u5907\u4f7f\u7528\u7684\u590d\u4f4d\u63a7\u5236\u3002",(0,s.jsx)(e.code,{children:"<&ccu RST_BUS_TWI0>"}),"\u8868\u793a\u8bbe\u5907\u4f7f\u7528\u4e86CCU\u4e2d\u7684",(0,s.jsx)(e.code,{children:"RST_BUS_TWI0"}),"\u590d\u4f4d\u63a7\u5236\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"dmas = <&dma 43>, <&dma 43>;"}),"\uff1aDMA\uff08Direct Memory Access\uff09\u63cf\u8ff0\uff0c\u6307\u5b9a\u4e86\u8bbe\u5907\u4f7f\u7528\u7684DMA\u901a\u9053\u3002\u8fd9\u91cc\u6307\u5b9a\u4e86\u4e24\u4e2aDMA\u901a\u9053\uff0c\u4e00\u4e2a\u7528\u4e8e\u4f20\u8f93\uff08tx\uff09\uff0c\u4e00\u4e2a\u7528\u4e8e\u63a5\u6536\uff08rx\uff09\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'dma-names = "tx", "rx";'}),'\uff1aDMA\u901a\u9053\u540d\u79f0\uff0c\u6307\u5b9a\u4e86DMA\u901a\u9053\u7684\u529f\u80fd\u540d\u79f0\uff0c\u5206\u522b\u662f"tx"\u548c"rx"\uff0c\u7528\u4e8e\u4f20\u8f93\u548c\u63a5\u6536\u3002']}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'status = "okay";'}),"\uff1a\u8bbe\u5907\u72b6\u6001\uff0c\u8868\u793a\u8bbe\u5907\u5904\u4e8e\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u4e3a\u4e86\u5728TWI\u603b\u7ebf\u9a71\u52a8\u4ee3\u7801\u4e2d\u533a\u5206\u6bcf\u4e00\u4e2aTWI\u63a7\u5236\u5668\uff0c\u9700\u8981\u5728Device Tree\u4e2d\u7684aliases\u8282\u70b9\u4e2d\u4e3a\u6bcf\u4e00\u4e2aTWI\u8282\u70b9\u6307\u5b9a\u522b\u540d\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"aliases {\r\n    twi0 = &twi0;\r\n    twi1 = &twi1;\r\n    twi2 = &twi2;\r\n    twi3 = &twi3;\r\n    ...\r\n};\n"})}),"\n",(0,s.jsxs)(e.p,{children:["TWI\u603b\u7ebf\u9a71\u52a8\u7a0b\u5e8f\u901a\u5e38\u4f1a\u5c06\u6bcf\u4e2aTWI\u63a7\u5236\u5668\u90fd\u5206\u914d\u4e00\u4e2a\u522b\u540d\uff0c\u5f62\u5f0f\u4e3a\u5b57\u7b26\u4e32\u201ctwi\u201d\u52a0\u8fde\u7eed\u7f16\u53f7\u7684\u6570\u5b57\uff0c\u4f8b\u5982\u201ctwi0\u201d\u3001\u201ctwi1\u201d\u7b49\u3002\u8fd9\u6837\u7684\u522b\u540d\u65b9\u4fbf\u5728\u4ee3\u7801\u4e2d\u5f15\u7528\u548c\u533a\u5206\u4e0d\u540c\u7684TWI\u63a7\u5236\u5668\u3002\u901a\u8fc7",(0,s.jsx)(e.code,{children:"of_alias_get_id()"}),"\u51fd\u6570\u53ef\u4ee5\u83b7\u53d6\u5bf9\u5e94TWI\u63a7\u5236\u5668\u7684\u6570\u5b57\u7f16\u53f7\uff0c\u7136\u540e\u6839\u636e\u7f16\u53f7\u6765\u786e\u5b9a\u5177\u4f53\u662f\u54ea\u4e2aTWI\u63a7\u5236\u5668\uff0c\u4ece\u800c\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002"]}),"\n",(0,s.jsx)(e.h3,{id:"\u677f\u7ea7\u914d\u7f6e",children:"\u677f\u7ea7\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&twi0 {\r\n\tclock-frequency = <400000>;\t\t    /* TWI\u63a7\u5236\u5668\u7684\u65f6\u949f\u9891\u7387 */\r\n\tpinctrl-names = "default", "sleep";\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u540d\u79f0 */\r\n\tpinctrl-0 = <&twi0_pins_default>;\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08default\uff09 */\r\n\tpinctrl-1 = <&twi0_pins_sleep>;\t\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08sleep\uff09 */\r\n\ttwi_drv_used = <1>;\t\t\t        /* \u662f\u5426\u542f\u7528drv\u6a21\u5f0f\u4f20\u8f93\u6570\u636e\uff1a0-engine\u6a21\u5f0f\uff0c1-drv\u6a21\u5f0f */\r\n\ttwi-supply = <&reg_dcdc1>;\t\t    /* regulator\u76f8\u5173\u914d\u7f6e */\r\n\tstatus = "okay";\t\t\t        /* \u8bbe\u5907\u662f\u5426\u4f7f\u7528 */\r\n\teeprom@50 {\t\t\t\t            /* eeprom\u4ece\u8bbe\u5907 */\r\n\t\tcompatible = "atmel,24c16";\t    /* eeprom\u4ece\u8bbe\u5907\u5bf9\u5e94\u7684\u8bbe\u5907\u9a71\u52a8compatible\uff0c\u7528\u4e8e\u9a71\u52a8\u548c\u8bbe\u5907\u7684\u7ed1\u5b9a */\r\n\t\treg = \u5c0f\u4e8e0x50>;\t\t\t        /* eeprom\u4ece\u8bbe\u5907\u5730\u5740\u4e3a0x50 */\r\n\t\tstatus = "disabled";\t\t    /* eeprom\u4ece\u8bbe\u5907status */\r\n\t};\r\n};\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"&twi0 { ... };"}),"\uff1a\u8fd9\u662fTWI\u63a7\u5236\u5668\u7684\u8282\u70b9\uff0c\u4f7f\u7528\u4e86\u522b\u540d\u201ctwi0\u201d\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"clock-frequency = <400000>;"}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u7684\u65f6\u949f\u9891\u7387\u4e3a400 kHz\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'pinctrl-names = "default", "sleep";'}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u5728\u4e0d\u540c\u72b6\u6001\u4e0b\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\u7684\u540d\u79f0\uff0c\u5206\u522b\u4e3a\u201cdefault\u201d\u548c\u201csleep\u201d\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"pinctrl-0 = <&twi0_pins_default>;"}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u5728\u9ed8\u8ba4\u72b6\u6001\u4e0b\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff0c\u5f15\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a\u201ctwi0_pins_default\u201d\u7684pin\u811a\u914d\u7f6e\u8282\u70b9\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"pinctrl-1 = <&twi0_pins_sleep>;"}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u5728\u7761\u7720\u72b6\u6001\u4e0b\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff0c\u5f15\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a\u201ctwi0_pins_sleep\u201d\u7684pin\u811a\u914d\u7f6e\u8282\u70b9\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"twi_drv_used = <1>;"}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u662f\u5426\u542f\u7528\u4e86drv\u6a21\u5f0f\u4f20\u8f93\u6570\u636e\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a1\u8868\u793a\u542f\u7528\u4e86drv\u6a21\u5f0f\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"twi-supply = <&reg_dcdc1>;"}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u4f7f\u7528\u7684\u7535\u6e90\u914d\u7f6e\uff0c\u5f15\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a\u201creg_dcdc1\u201d\u7684\u7535\u6e90\u8282\u70b9\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'status = "okay";'}),"\uff1a\u6307\u5b9a\u4e86TWI\u63a7\u5236\u5668\u5904\u4e8e\u6b63\u5e38\u5de5\u4f5c\u72b6\u6001\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"eeprom@50 { ... };"}),"\uff1a\u8fd9\u662f\u4e00\u4e2aEEPROM\u4ece\u8bbe\u5907\u7684\u8282\u70b9\uff0c\u4f7f\u7528\u4e86\u522b\u540d\u201ceeprom\u201d\uff0c\u5730\u5740\u4e3a0x50\u3002"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'compatible = "atmel,24c16";'}),"\uff1a\u6307\u5b9a\u4e86EEPROM\u4ece\u8bbe\u5907\u7684\u8bbe\u5907\u9a71\u52a8\u517c\u5bb9\u6027\uff0c\u8fd9\u91cc\u662fAtmel 24C16\u578b\u53f7\u7684EEPROM\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"reg = \u5c0f\u4e8e0x50>;"}),"\uff1a\u6307\u5b9a\u4e86EEPROM\u4ece\u8bbe\u5907\u7684\u5730\u5740\uff0c\u8fd9\u91cc\u662f0x50\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:'status = "disabled";'}),"\uff1a\u6307\u5b9a\u4e86EEPROM\u4ece\u8bbe\u5907\u5904\u4e8e\u7981\u7528\u72b6\u6001\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u5de5\u4f5c\u6a21\u5f0f",children:"\u5de5\u4f5c\u6a21\u5f0f"}),"\n",(0,s.jsx)(e.h3,{id:"master-\u6a21\u5f0f",children:"master \u6a21\u5f0f"}),"\n",(0,s.jsx)(e.p,{children:"TWI\u63a7\u5236\u5668\u9ed8\u8ba4\u5de5\u4f5c\u5728master\u6a21\u5f0f\uff0c\u65e0\u9700\u5176\u4ed6\u989d\u5916\u914d\u7f6e\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"engine-\u6a21\u5f0f\u914d\u7f6e",children:"engine \u6a21\u5f0f\u914d\u7f6e"}),"\n",(0,s.jsxs)(e.p,{children:["engine\u662f\u4e2d\u65ad\u6a21\u5f0f\u9a71\u52a8\u901a\u4fe1\uff0c\u5360\u7528cpu\u8d44\u6e90\uff0c\u53ef\u505aslave\u6a21\u5f0f\uff0c\u65f6\u949f\u5ef6\u5c55\uff0c",(0,s.jsx)(e.strong,{children:"\u4e00\u822c\u4f5cslave\u6216\u8005slave\u8bbe\u5907\u9700\u8981\u65f6\u949f\u5ef6\u5c55\u7279\u6027\u65f6\u624d\u4f7f\u7528engine\u6a21\u5f0f"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5de5\u4f5c\u5728engine\u6a21\u5f0f\uff0c\u4e3b\u8981\u662f\u914d\u7f6etwi_drv_used = \u5c0f\u4e8e0>\u5c5e\u6027\uff0cTWI\u6a21\u5757\u5728",(0,s.jsx)(e.strong,{children:"dts\u6587\u4ef6"}),"\u4e2d\u7684\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&twi0 {\r\n\tclock-frequency = <400000>;\t\t/* TWI\u63a7\u5236\u5668\u7684\u65f6\u949f\u9891\u7387 */\r\n\tpinctrl-names = "default", "sleep";\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u540d\u79f0 */\r\n\tpinctrl-0 = <&twi0_pins_default>;\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08default\uff09 */\r\n\tpinctrl-1 = <&twi0_pins_sleep>;\t\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08sleep\uff09 */\r\n\ttwi_drv_used = \u5c0f\u4e8e0>;\t\t\t/* \u662f\u5426\u542f\u7528drv\u6a21\u5f0f\u4f20\u8f93\u6570\u636e\uff1a0-engine\u6a21\u5f0f */\r\n\tno_suspend = <1>;\t\t\t/* \u9ed8\u8ba4\u4e3a0\uff0c\u65e0\u9700\u914d\u7f6e\uff1b\u5f53pmu\u4f9d\u8d56twi\u65f6\u9700\u8981\u7f6e1\uff0c\u6807\u8bc6twi\u5728\u4f11\u7720\u5524\u9192\u9636\u6bb5\u4e0d\u4f11\u7720 */\r\n\tstatus = "okay";\t\t\t/* \u8bbe\u5907\u662f\u5426\u4f7f\u7528 */\r\n};\n'})}),"\n",(0,s.jsx)(e.h3,{id:"drv-\u6a21\u5f0f\u914d\u7f6e",children:"drv \u6a21\u5f0f\u914d\u7f6e"}),"\n",(0,s.jsxs)(e.p,{children:["drv\u6a21\u5f0f\u5bf9cpu\u5360\u7528\u4f4e\uff0c\u7a33\u5b9a\u6027\u9ad8\uff0c",(0,s.jsx)(e.strong,{children:"\u4e00\u822cmaster\u6a21\u5f0f\u4e0b\uff0c\u9ed8\u8ba4\u4f7f\u7528drv\u6a21\u5f0f"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5de5\u4f5c\u5728drv\u6a21\u5f0f\uff0c\u4e3b\u8981\u662f\u914d\u7f6e ",(0,s.jsx)(e.code,{children:"twi_drv_used = <1>"})," \u5c5e\u6027\uff0cTWI\u6a21\u5757\u5728",(0,s.jsx)(e.strong,{children:"dts\u6587\u4ef6"}),"\u4e2d\u7684\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&twi0 {\r\n\tclock-frequency = <400000>;\t\t/* TWI\u63a7\u5236\u5668\u7684\u65f6\u949f\u9891\u7387 */\r\n\tpinctrl-names = "default", "sleep";\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u540d\u79f0 */\r\n\tpinctrl-0 = <&twi0_pins_default>;\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08default\uff09 */\r\n\tpinctrl-1 = <&twi0_pins_sleep>;\t\t/* \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08sleep\uff09 */\r\n\ttwi_drv_used = <1>;\t\t\t/* \u662f\u5426\u542f\u7528drv\u6a21\u5f0f\u4f20\u8f93\u6570\u636e\uff1a1-drv\u6a21\u5f0f */\r\n\tno_suspend = <1>;\t\t\t/* \u9ed8\u8ba4\u4e3a0\uff0c\u65e0\u9700\u914d\u7f6e\uff1b\u5f53pmu\u4f9d\u8d56twi\u65f6\u9700\u8981\u7f6e1\uff0c\u6807\u8bc6twi\u5728\u4f11\u7720\u5524\u9192\u9636\u6bb5\u4e0d\u4f11\u7720 */\r\n\tstatus = "okay";\t\t\t/* \u8bbe\u5907\u662f\u5426\u4f7f\u7528 */\r\n};\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u4f20\u8f93\u901f\u7387\u914d\u7f6e",children:"\u4f20\u8f93\u901f\u7387\u914d\u7f6e"}),"\n",(0,s.jsxs)(e.p,{children:["\u5de5\u4f5c\u5728\u6807\u51c6\u6a21\u5f0f\uff0c\u65f6\u949f\u9891\u7387\u4e3a100k\uff0c\u914d\u7f6e",(0,s.jsx)(e.code,{children:"clock-frequency = <100000>\uff1b"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u5de5\u4f5c\u5728\u5feb\u901f\u6a21\u5f0f\uff0c\u65f6\u949f\u9891\u7387\u4e3a400k\uff0c\u4e3b\u8981\u914d\u7f6e",(0,s.jsx)(e.code,{children:"clock-frequency = <400000>\u3002"})]}),"\n",(0,s.jsxs)(e.p,{children:["TWI\u6a21\u5757\u5728",(0,s.jsx)(e.strong,{children:"dts\u6587\u4ef6"}),"\u4e2d\u7684\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"&twi0 {\r\n    clock-frequency = <400000>;/* TWI\u63a7\u5236\u5668\u7684\u65f6\u949f\u9891\u7387\uff0c\u9ed8\u8ba4\u4e3a400k */\r\n    ...\r\n};\n"})}),"\n",(0,s.jsx)(e.h3,{id:"slave-\u6a21\u5f0f",children:"slave \u6a21\u5f0f"}),"\n",(0,s.jsx)(e.p,{children:"TWI\u63a7\u5236\u5668\u652f\u6301\u4f5c\u4e3a\u4ece\u673a\u4f7f\u7528\uff0c\u4f46\u662f\u9ed8\u8ba4\u5de5\u4f5c\u5728master\u6a21\u5f0f\uff0cslave\u6a21\u5f0f\u9700\u8981\u7279\u6b8a\u914d\u7f6e\u3002"}),"\n",(0,s.jsx)(e.h4,{id:"\u5185\u6838\u9a71\u52a8\u914d\u7f6e",children:"\u5185\u6838\u9a71\u52a8\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"Device Drivers  ---\x3e\r\n    I2C support  ---\x3e\r\n        [*]   I2C slave support\r\n        <*>     I2C eeprom slave driver\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20240514124616982",src:i(10015).Z+"",width:"1093",height:"582"})}),"\n",(0,s.jsx)(e.p,{children:"slave\u6a21\u5f0f\u65f6TWI\u63a7\u5236\u5668\u9700\u8981\u914d\u7f6e\u4e3aengine\u6a21\u5f0f\uff0c\u5e76\u4e14\u5728dts\u4e2d\u6ce8\u518c\u4e3aslave\uff0c\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,s.jsxs)(e.p,{children:["TWI\u6a21\u5757\u5728",(0,s.jsx)(e.strong,{children:"dts\u6587\u4ef6"}),"\u4e2d\u7684\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'&twi0 {\r\n        ...\r\n        twi_drv_used = \u5c0f\u4e8e0>;  /* slave must work in engine-mode */\r\n        status = "okay";\r\n        slave {\r\n                compatible = "slave-24c02";  /* Slave device drivers provided by the kernel */\r\n                reg = \u5c0f\u4e8e0x50>;  /* slave_addr\uff0c\u53ef\u4ee5\u4fee\u6539 */\r\n                status = "okay";\r\n        };\r\n};\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u6309\u4e0a\u8ff0\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u8be5TWI\u63a7\u5236\u5668\u5373\u6ce8\u518c\u4e3a\u4e00\u4e2a\u4ece\u8bbe\u5907\uff0c\u8bbe\u5907\u5730\u5740\u4e3a\u4e0a\u8ff0\u5b9a\u4e49\u7684slave_addr\uff0c\u8be5TWI\u63a7\u5236\u5668\u4e0e\u5176\u4ed6master\u7684sck\u548csda\u8fde\u63a5\u540e\u53ef\u4ee5\u8fdb\u884c\u6b63\u5e38\u901a\u4fe1\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"\u6a21\u5757\u4ecb\u7ecd",children:"\u6a21\u5757\u4ecb\u7ecd"}),"\n",(0,s.jsx)(e.p,{children:"Linux\u4e2d\u7684I2C\u4f53\u7cfb\u7ed3\u6784\u662f\u6307Linux\u5185\u6838\u4e2d\u7528\u4e8e\u7ba1\u7406\u548c\u63a7\u5236I2C\uff08Inter-Integrated Circuit\uff09\u603b\u7ebf\u7684\u7ec4\u7ec7\u7ed3\u6784\u548c\u67b6\u6784\u3002I2C\u603b\u7ebf\u662f\u4e00\u79cd\u4e32\u884c\u901a\u4fe1\u603b\u7ebf\uff0c\u5e38\u7528\u4e8e\u8fde\u63a5\u5fae\u63a7\u5236\u5668\u3001\u4f20\u611f\u5668\u3001\u5b58\u50a8\u5668\u548c\u5176\u4ed6\u5916\u8bbe\uff0c\u4ee5\u5b9e\u73b0\u5b83\u4eec\u4e4b\u95f4\u7684\u901a\u4fe1\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u5728Linux\u5185\u6838\u4e2d\uff0cI2C\u4f53\u7cfb\u7ed3\u6784\u4e3b\u8981\u7531\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u7528\u6237\u7a7a\u95f4"}),"\uff1a\u7528\u6237\u7a7a\u95f4\u5305\u62ec\u6240\u6709\u4f7f\u7528I2C\u8bbe\u5907\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u7cfb\u7edf\u63d0\u4f9b\u7684\u63a5\u53e3\u4e0e\u5185\u6838\u8fdb\u884c\u901a\u4fe1\uff0c\u4ece\u800c\u4e0eI2C\u8bbe\u5907\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u5185\u6838\u7a7a\u95f4"}),"\uff1a\u5185\u6838\u7a7a\u95f4\u5305\u62ec\u4e86\u9a71\u52a8\u7a0b\u5e8f\u548c\u7ba1\u7406I2C\u603b\u7ebf\u7684\u6838\u5fc3\u6a21\u5757\u3002\u8fd9\u4e9b\u6a21\u5757\u8d1f\u8d23\u5b9e\u73b0\u5bf9I2C\u603b\u7ebf\u548c\u8fde\u63a5\u5728\u4e0a\u9762\u7684\u8bbe\u5907\u7684\u7ba1\u7406\u548c\u63a7\u5236\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u786c\u4ef6"}),"\uff1a\u786c\u4ef6\u90e8\u5206\u5305\u62ec\u4e86\u5b9e\u9645\u7684\u7269\u7406\u8bbe\u5907\uff0c\u5305\u62ecI2C\u63a7\u5236\u5668\u548cI2C\u5916\u8bbe\u3002I2C\u63a7\u5236\u5668\u901a\u5e38\u96c6\u6210\u5728\u4e3b\u677f\u6216\u8005\u5904\u7406\u5668\u4e2d\uff0c\u800c\u5916\u8bbe\u5219\u8fde\u63a5\u5728I2C\u603b\u7ebf\u4e0a\uff0c\u901a\u8fc7\u63a7\u5236\u5668\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5728Linux\u5185\u6838\u4e2d\uff0c\u5bf9I2C\u603b\u7ebf\u7684\u7ba1\u7406\u548c\u63a7\u5236\u662f\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u6a21\u5757\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e9b\u6a21\u5757\u5305\u62ec\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"I2C\u6838\u5fc3\uff08I2C core\uff09"}),"\uff1a\u8d1f\u8d23\u63d0\u4f9b\u5bf9I2C\u603b\u7ebf\u7684\u6838\u5fc3\u529f\u80fd\u548c\u62bd\u8c61\uff0c\u5305\u62ec\u5bf9I2C\u63a7\u5236\u5668\u548c\u5916\u8bbe\u7684\u7ba1\u7406\u3001\u6570\u636e\u4f20\u8f93\u7b49\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"I2C\u63a7\u5236\u5668\u9a71\u52a8\u7a0b\u5e8f\uff08I2C controller drivers\uff09"}),"\uff1a\u8fd9\u4e9b\u9a71\u52a8\u7a0b\u5e8f\u8d1f\u8d23\u4e0e\u786c\u4ef6I2C\u63a7\u5236\u5668\u8fdb\u884c\u901a\u4fe1\uff0c\u5e76\u63d0\u4f9b\u7edf\u4e00\u7684\u63a5\u53e3\u7ed9\u4e0a\u5c42\u7684I2C\u6838\u5fc3\u6a21\u5757\u4f7f\u7528\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"I2C\u4ece\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff08I2C client drivers\uff09"}),"\uff1a\u8fd9\u4e9b\u9a71\u52a8\u7a0b\u5e8f\u8d1f\u8d23\u4e0e\u8fde\u63a5\u5728I2C\u603b\u7ebf\u4e0a\u7684\u5916\u8bbe\u8fdb\u884c\u901a\u4fe1\uff0c\u5e76\u63d0\u4f9b\u76f8\u5e94\u7684\u529f\u80fd\u7ed9\u4e0a\u5c42\u7684\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"I2C\u603b\u7ebf\u9a71\u52a8\u7a0b\u5e8f\uff08I2C bus drivers\uff09"}),"\uff1a\u8fd9\u4e9b\u9a71\u52a8\u7a0b\u5e8f\u8d1f\u8d23\u7ba1\u7406\u548c\u63a7\u5236\u7279\u5b9a\u7c7b\u578b\u7684I2C\u603b\u7ebf\uff0c\u4f8b\u5982SMBus\u7b49\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u8fc7\u8fd9\u4e9b\u6a21\u5757\u7684\u534f\u540c\u5de5\u4f5c\uff0cLinux\u5185\u6838\u53ef\u4ee5\u5b9e\u73b0\u5bf9I2C\u603b\u7ebf\u7684\u7ba1\u7406\u548c\u63a7\u5236\uff0c\u4f7f\u5f97\u5f00\u53d1\u8005\u53ef\u4ee5\u65b9\u4fbf\u5730\u4f7f\u7528\u548c\u64cd\u4f5c\u8fde\u63a5\u5728I2C\u603b\u7ebf\u4e0a\u7684\u5404\u79cd\u5916\u8bbe\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u6a21\u5757\u521d\u59cb\u5316\u6d41\u7a0b",children:"\u6a21\u5757\u521d\u59cb\u5316\u6d41\u7a0b"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20240514124918500",src:i(2436).Z+"",width:"187",height:"545"})}),"\n",(0,s.jsx)(e.p,{children:"I2C\u8bbe\u5907\u521d\u59cb\u5316\u6d41\u7a0b\u5982\u4e0b\u6240\u793a:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u83b7\u53d6I2C\u8bbe\u5907\u7684\u65f6\u949f\uff0c\u83b7\u53d6\u7535\u6e90\u914d\u7f6e\uff0c\u83b7\u53d6\u5f15\u811a\u914d\u7f6e"}),"\n",(0,s.jsx)(e.li,{children:"\u914d\u7f6e\u7535\u6e90\u9002\u914d\u5668\uff0c\u914d\u7f6e\u5f15\u811a\uff0c\u914d\u7f6e\u65f6\u949f"}),"\n",(0,s.jsx)(e.li,{children:"\u5982\u679c\u9700\u8981\u4f7f\u7528DMA\u4f20\u8f93\uff0c\u8f6f\u91cd\u542f\u8bbe\u5907"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u6a21\u5757\u6570\u636e\u53d1\u9001\u6d41\u7a0b",children:"\u6a21\u5757\u6570\u636e\u53d1\u9001\u6d41\u7a0b"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20240514124939886",src:i(77338).Z+"",width:"444",height:"628"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5f53\u4e0a\u5c42\u5e94\u7528\u4f7f\u7528I2C\u5728\u4f20\u8f93\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u8c03\u7528\u4f1a ",(0,s.jsx)(e.code,{children:"twi\\_algorithm"})," \u7ed3\u6784\u4f53\u7684 ",(0,s.jsx)(e.code,{children:"master_xfer"})," \u51fd\u6570\uff0c\u5177\u4f53\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"static const struct i2c_algorithm sunxi_twi_algorithm = {\r\n\t.master_xfer\t  = sunxi_twi_xfer,\r\n\t.functionality\t  = sunxi_twi_functionality,\r\n#if IS_ENABLED(CONFIG_I2C_SLAVE)\r\n\t.reg_slave        = sunxi_twi_reg_slave,\r\n\t.unreg_slave      = sunxi_twi_unreg_slave,\r\n#endif\r\n};\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5176\u4e2d ",(0,s.jsx)(e.code,{children:"sunxi_twi_xfer"})," \u7684\u5b9a\u4e49\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"static int sunxi_twi_xfer(struct i2c_adapter *adap, struct i2c_msg *msgs, int num)\r\n{\r\n\tstruct sunxi_twi *twi = (struct sunxi_twi *)adap->algo_data;\r\n\t...\r\n\t/* then the sunxi_twi_runtime_reseme() call back */\r\n\tret = pm_runtime_get_sync(twi->dev);\r\n\tsunxi_twi_soft_reset(twi);\t\t\t\t\t\t\t//\u8f6f\u91cd\u542fI2C\r\n\tret = sunxi_twi_bus_barrier(&twi->adap);\r\n\t/* set the twi status to idle */\r\n\ttwi->result = RESULT_IDLE;\r\n\tif (twi->twi_drv_used)\r\n\t\tret = sunxi_twi_drv_xfer(twi, msgs, num);\t\t//drv\u6a21\u5f0f\r\n\telse\r\n\t\tret = sunxi_twi_engine_xfer(twi, msgs, num);\t//engine\u6a21\u5f0f\r\n\r\n\treturn ret;\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u53ef\u89c1\u8be5\u51fd\u6570\u662f\u5224\u65ad\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"engine"})," \u6a21\u5f0f\u4f20\u8f93\u6570\u636e\u8fd8\u662f ",(0,s.jsx)(e.code,{children:"drv"})," \u6a21\u5f0f\u4f20\u8f93\u6570\u636e\uff0c\u5176\u51b3\u5b9a\u4e8e\u8bbe\u5907\u6811\u4e2d\u7684 ",(0,s.jsx)(e.code,{children:"twi_drv_used"})," \u914d\u7f6e\u3002\r\n\u4e0b\u9762\u5c06\u4f1a\u5bf9 ",(0,s.jsx)(e.code,{children:"engine"}),"\u6a21\u5f0f\u7684\u4f20\u8f93\u6d41\u7a0b\u8fdb\u884c\u5206\u6790\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20240514125043775",src:i(34664).Z+"",width:"409",height:"584"})}),"\n",(0,s.jsx)(e.p,{children:"\u5728\u8be5\u4f20\u8f93\u4e2d\uff0c\u5148\u91cd\u542fTWI\u8bbe\u5907\uff0c\u5728\u914d\u7f6e\u9700\u8981\u4f20\u8f93\u7684\u6570\u636e\uff0c\u4f7f\u80fdTWI\u4e2d\u65ad\uff0c\u7136\u540e\u542f\u52a8TWI\u8fdb\u884c\u6570\u636e\u7684\u4f20\u8f93\uff0c\u7b49\u5f85\u6570\u636e\u4f20\u8f93\u5b8c\u6bd5\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u6a21\u5757-delay-init-\u5904\u7406\u6d41\u7a0b",children:"\u6a21\u5757 Delay Init \u5904\u7406\u6d41\u7a0b"}),"\n",(0,s.jsxs)(e.p,{children:["\u5bf9\u4e8e ",(0,s.jsx)(e.code,{children:"delay_init"})," \u7684\u5904\u7406\u6d41\u7a0b\uff0c\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Linux\u9a71\u52a8\u7684\u521d\u59cb\u5316"}),"\uff1a\u5728Linux\u5185\u6838\u542f\u52a8\u65f6\uff0c\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u88ab\u52a0\u8f7d\uff0c\u5e76\u4e14\u6267\u884c\u76f8\u5e94\u7684probe\u51fd\u6570\u6765\u521d\u59cb\u5316\u8bbe\u5907\u3002\u5728TWI\uff08Two-Wire Interface\uff0c\u53cc\u7ebf\u63a5\u53e3\uff09\u9a71\u52a8\u4e2d\uff0c\u901a\u5e38\u4f1a\u6267\u884cprobe\u51fd\u6570\u6765\u83b7\u53d6\u548c\u521d\u59cb\u5316\u786c\u4ef6\u8d44\u6e90\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8df3\u8fc7\u786c\u4ef6\u8d44\u6e90\u83b7\u53d6"}),"\uff1a\u7531\u4e8e\u9700\u8981\u5728\u5f02\u6784\u7cfb\u7edf\u4e2d\u5148\u7531\u5f02\u6784\u5c0f\u6838\u4f7f\u7528TWI\u8d44\u6e90\uff0c\u56e0\u6b64\u5728Linux\u6267\u884cprobe\u51fd\u6570\u65f6\uff0c\u9700\u8981\u8df3\u8fc7\u786c\u4ef6\u8d44\u6e90\u7684\u83b7\u53d6\u90e8\u5206\uff0c\u4e5f\u5c31\u662f\u6682\u65f6\u4e0d\u6267\u884csunxi_twi_hw_init()\u51fd\u6570\uff0c\u4ee5\u907f\u514d\u4e0e\u5f02\u6784\u5c0f\u6838\u7684\u8d44\u6e90\u4f7f\u7528\u51b2\u7a81\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u7b49\u5f85\u8fdc\u7aef\u4fe1\u53f7\u901a\u77e5"}),"\uff1aLinux\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u4f1a\u542f\u52a8\u4e00\u4e2a\u7b49\u5f85\u673a\u5236\uff0c\u7b49\u5f85\u6765\u81ea\u8fdc\u7aef\u7684\u4fe1\u53f7\u901a\u77e5\uff0c\u4ee5\u786e\u5b9a\u4f55\u65f6\u53ef\u4ee5\u5b89\u5168\u5730\u521d\u59cb\u5316TWI\u8d44\u6e90\u3002\u8fd9\u4e2a\u4fe1\u53f7\u901a\u77e5\u901a\u5e38\u901a\u8fc7rpmsg\uff08Remote Processor Messaging\uff09\u7b49\u65b9\u5f0f\u8fdb\u884c\u4f20\u9012\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u63a5\u6536\u4fe1\u53f7\u901a\u77e5"}),"\uff1a\u4e00\u65e6\u8fdc\u7aef\u5b8c\u6210\u4e86\u5bf9TWI\u8d44\u6e90\u7684\u4f7f\u7528\uff0c\u5e76\u4e14\u901a\u8fc7rpmsg\u5411Linux\u53d1\u9001\u4e86\u4fe1\u53f7\u901a\u77e5\uff0cLinux\u4f1a\u6536\u5230\u8fd9\u4e2a\u901a\u77e5\uff0c\u5e76\u4e14\u5728\u63a5\u6536\u5230\u901a\u77e5\u540e\u6267\u884c\u76f8\u5e94\u7684\u5904\u7406\u7a0b\u5e8f\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6267\u884c\u8d44\u6e90\u83b7\u53d6\u51fd\u6570"}),"\uff1a\u5728\u63a5\u6536\u5230\u8fdc\u7aef\u4fe1\u53f7\u901a\u77e5\u540e\uff0cLinux\u4f1a\u6267\u884cTWI\u9a71\u52a8\u4e2d\u7684\u8d44\u6e90\u83b7\u53d6\u51fd\u6570\uff0c\u4f8b\u5982sunxi_twi_hw_init()\uff0c\u4ee5\u5b8c\u6210\u5bf9TWI\u8d44\u6e90\u7684\u521d\u59cb\u5316\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u8fc7\u4ee5\u4e0a\u6d41\u7a0b\uff0cLinux\u53ef\u4ee5\u5728\u5f02\u6784\u7cfb\u7edf\u4e2d\u5e73\u6ed1\u5730\u4e0e\u5f02\u6784\u5c0f\u6838\u8fdb\u884cTWI\u8d44\u6e90\u7684\u5171\u4eab\u548c\u5207\u6362\uff0c\u786e\u4fdd\u5728\u4f7f\u7528\u7ed3\u675f\u540e\u53ca\u65f6\u521d\u59cb\u5316TWI\u8d44\u6e90\uff0c\u907f\u514d\u8d44\u6e90\u7ade\u4e89\u548c\u51b2\u7a81\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u4f11\u7720\u5524\u9192\u5904\u7406\u6d41\u7a0b",children:"\u4f11\u7720\u5524\u9192\u5904\u7406\u6d41\u7a0b"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8fd0\u884c\u65f6\u4f11\u7720\u5524\u9192\u5904\u7406\u6d41\u7a0b"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Runtime Suspend/Runtime Resume\u51fd\u6570\u4f7f\u7528"}),"\uff1a\u901a\u8fc7\u5728TWI\u9a71\u52a8\u4e2d\u5b9e\u73b0runtime_suspend\u548cruntime_resume\u51fd\u6570\uff0c\u53ef\u4ee5\u5b9e\u73b0TWI\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u672a\u88ab\u8c03\u7528\u65f6\u81ea\u52a8\u8fdb\u5165\u4f11\u7720\u72b6\u6001\uff0c\u4ee5\u8282\u7701\u80fd\u8017\uff0c\u5e76\u5728\u9700\u8981\u65f6\u81ea\u52a8\u5524\u9192\u6062\u590d\u6b63\u5e38\u5de5\u4f5c\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u7cfb\u7edf\u4f11\u7720\u5524\u9192\u65f6\u7684\u5904\u7406"}),"\uff1a\u5728\u7cfb\u7edf\u4f11\u7720\u8fc7\u7a0b\u4e2d\uff0c\u9488\u5bf9\u975ePMU\uff08Power Management Unit\uff09\u4f7f\u7528\u7684TWI\uff0c\u9996\u5148\u5173\u95edI2C\u5b50\u7cfb\u7edf\u7684\u8c03\u7528\uff0c\u5e76\u786e\u4fdd\u4efb\u4f55\u6b63\u5728\u8fdb\u884c\u7684\u6570\u636e\u4f20\u8f93\u90fd\u5df2\u5b8c\u6210\u3002\u6700\u540e\uff0c\u8c03\u7528pm_runtime_force_suspend\u51fd\u6570\u5173\u95ed\u7535\u6e90\u3001\u603b\u7ebf\u3001\u65f6\u949f\u548c\u5f15\u811a\uff0c\u5c06TWI\u72b6\u6001\u8bbe\u7f6e\u4e3asuspended\u3002\u800c\u5bf9\u4e8ePMU\u4f7f\u7528\u7684TWI\uff0c\u76f4\u63a5\u9000\u51fa\uff0c\u4ee5\u786e\u4fdd\u5728CPU\u548c\u5524\u9192\u65f6\u80fd\u591f\u6b63\u5e38\u4f7f\u7528\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u7cfb\u7edf\u5524\u9192\u65f6\u7684\u5904\u7406"}),"\uff1a\u5728\u7cfb\u7edf\u5524\u9192\u65f6\uff0c\u5bf9\u4e8e\u975ePMU\u4f7f\u7528\u7684TWI\uff0c\u53ea\u8fdb\u884c\u4e0a\u7535\u64cd\u4f5c\uff0c\u800c\u4e0d\u4f1a\u771f\u6b63\u8c03\u7528\u5230runtime_resume\u51fd\u6570\u3002TWI\u4f1a\u5728\u88ab\u771f\u6b63\u4f7f\u7528\u65f6\uff0c\u901a\u8fc7\u8c03\u7528runtime_resume\u51fd\u6570\u6765\u4f7f\u80fd\u603b\u7ebf\u3001\u65f6\u949f\u548c\u5f15\u811a\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6ce8\u610f\u4e8b\u9879"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6a21\u5757\u7684\u4f11\u7720\u5524\u9192\u51fd\u6570\u8c03\u7528\u987a\u5e8f"}),"\uff1a\u786e\u4fddTWI\u7684\u4f11\u7720\u5524\u9192\u51fd\u6570\u5728TWI\u7684\u4f7f\u7528\u4e4b\u524d\u6267\u884c\uff0c\u4ee5\u786e\u4fdd\u5728TWI\u8fdb\u884c\u4f20\u8f93\u65f6\uff0cTWI\u8d44\u6e90\u5df2\u7ecf\u51c6\u5907\u597d\u5e76\u80fd\u591f\u6b63\u5e38\u4f7f\u7528\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u65f6\u949f\u7684\u7a33\u5b9a\u6027"}),"\uff1a\u5728\u4f11\u7720\u671f\u95f4\u786e\u4fddTWI\u7684\u7236\u65f6\u949f\u672a\u88ab\u4fee\u6539\uff0c\u4ee5\u514d\u5728\u5524\u9192\u540e\u5bfc\u81f4TWI\u56e0\u65f6\u949f\u9891\u7387\u5f02\u5e38\u800c\u65e0\u6cd5\u5de5\u4f5c\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u5173\u673a\u6d41\u7a0b",children:"\u5173\u673a\u6d41\u7a0b"}),"\n",(0,s.jsx)(e.p,{children:"\u5173\u673a\u6d41\u7a0b\u4e2d\u5bf9TWI\u7684\u5904\u7406\u6d41\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5bf9\u4e8ePMU\u4f7f\u7528\u7684TWI"}),"\uff1a\u76f4\u63a5\u9000\u51fa\uff0c\u4ee5\u786e\u4fdd\u5728CPUs\u4e2d\u80fd\u591f\u7ee7\u7eed\u6b63\u5e38\u4f7f\u7528\u5b8c\u6210\u5173\u673a\uff0c\u4e0d\u505a\u4efb\u4f55\u5904\u7406\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5bf9\u4e8e\u6b63\u5728\u4f7f\u7528\u4e2d\u7684TWI"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u786e\u4fdd\u4f20\u8f93\u5b8c\u6210\u6700\u540e\u4e00\u7b14\u6570\u636e\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u4fee\u6539TWI\u72b6\u6001\u4e3aSUNXI_TWI_XFER_STATUS_SHUTDOWN\uff0c\u8868\u793aTWI\u5df2\u5904\u4e8e\u5173\u673a\u72b6\u6001\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"TWI\u5904\u4e8eSUNXI_TWI_XFER_STATUS_SHUTDOWN\u72b6\u6001\u65f6\u7684\u884c\u4e3a"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5f53TWI\u5904\u4e8eSUNXI_TWI_XFER_STATUS_SHUTDOWN\u72b6\u6001\u65f6\uff0c\u8c03\u7528i2c_transfer\u51fd\u6570\u4f1a\u663e\u793a\u5931\u8d25\uff0c\u5373TWI\u62d2\u7edd\u88ab\u4f7f\u7528\u3002\u8fd9\u662f\u4e3a\u4e86\u907f\u514d\u5728\u5173\u673a\u8fc7\u7a0b\u4e2d\u5bf9TWI\u8fdb\u884c\u64cd\u4f5c\uff0c\u4ee5\u786e\u4fdd\u5b89\u5168\u5173\u673a\u548c\u7cfb\u7edf\u7a33\u5b9a\u6027\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u6a21\u5757\u5185\u90e8\u63a5\u53e3",children:"\u6a21\u5757\u5185\u90e8\u63a5\u53e3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"static int sunxi_twi_xfer(struct i2c_adapter *adap, struct i2c_msg *msgs, int num)\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u529f\u80fd\u63cf\u8ff0"}),"\uff1a\u5f53I2C Core\u53d1\u6765\u6d88\u606f\u65f6\uff0c\u8be5\u63a5\u53e3\u88ab\u8c03\u7528\u4ee5\u542f\u52a8\u4e00\u6b21I2C\u7684\u8bfb\u5199\u64cd\u4f5c\uff0c\u9996\u5148\u53d1\u9001Start\u4fe1\u53f7\uff0c\u7136\u540e\u6267\u884c\u6d88\u606f\u4e2d\u6307\u5b9a\u7684\u8bfb\u5199\u64cd\u4f5c\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570\u8bf4\u660e"}),"\uff1aadap\u6307\u5411\u5f53\u524d\u7684I2C\u9002\u914d\u5668\uff0cmsgs\u6307\u5411\u5f85\u5904\u7406\u7684I2C\u6d88\u606f\u6570\u7ec4\uff0cnum\u8868\u793a\u5f85\u5904\u7406\u7684I2C\u6d88\u606f\u4e2a\u6570\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a\u8fd4\u56de\u5df2\u6210\u529f\u5904\u7406\u7684I2C\u6d88\u606f\u4e2a\u6570\uff0c\u786e\u4fdd\u6d88\u606f\u88ab\u6b63\u786e\u53d1\u9001\u548c\u5904\u7406\u3002"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"static irqreturn_t sunxi_twi_handler(int this_irq, void * dev_id)\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u529f\u80fd\u63cf\u8ff0"}),"\uff1a\u5904\u7406TWI\u63a7\u5236\u5668\u4ea7\u751f\u7684\u4e2d\u65ad\u4fe1\u53f7\uff0c\u5373\u5f53TWI\u63a7\u5236\u5668\u89e6\u53d1\u4e2d\u65ad\u65f6\uff0c\u8be5\u51fd\u6570\u88ab\u8c03\u7528\u4ee5\u8fdb\u884c\u4e2d\u65ad\u5904\u7406\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570\u8bf4\u660e"}),"\uff1athis_irq\u8868\u793a\u4e2d\u65ad\u53f7\uff0cdev_id\u662f\u81ea\u5b9a\u4e49\u7684\u56de\u8c03\u53c2\u6570\uff0c\u901a\u5e38\u662f\u6307\u5411struct sunxi_twi\u7ed3\u6784\u4f53\u7684\u6307\u9488\uff0c\u7528\u4e8e\u5728\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u4e2d\u83b7\u53d6TWI\u63a7\u5236\u5668\u7684\u76f8\u5173\u4fe1\u606f\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1aIRQ_HANDLED\u8868\u793a\u4e2d\u65ad\u5df2\u7ecf\u88ab\u6b63\u786e\u5904\u7406\uff0cIRQ_NONE\u8868\u793a\u4e0d\u662f\u6b64\u8bbe\u5907\u7684\u4e2d\u65ad\uff0c\u901a\u5e38\u5728\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u65e0\u6cd5\u5904\u7406\u8be5\u4e2d\u65ad\u65f6\u8fd4\u56de\u3002"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"i2c-core-\u63a5\u53e3",children:"I2C CORE \u63a5\u53e3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"int i2c_transfer(struct i2c_adapter *adap, struct i2c_msg *msgs, int num);\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5b8c\u6210TWI\u603b\u7ebf\u548cTWI\u8bbe\u5907\u4e4b\u95f4\u7684\u4e00\u5b9a\u6570\u76ee\u7684TWI\u6d88\u606f\u4ea4\u4e92\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"adap"}),"\uff1a\u6307\u5411\u6240\u5c5e\u7684TWI\u603b\u7ebf\u63a7\u5236\u5668\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"msgs"}),"\uff1a\u6307\u5411i2c_msg\u7c7b\u578b\u7684\u6307\u9488\uff0c\u8868\u793a\u5f85\u5904\u7406\u7684TWI\u6d88\u606f\u6570\u7ec4\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"num"}),"\uff1a\u8868\u793a\u4e00\u6b21\u9700\u8981\u5904\u7406\u51e0\u4e2aTWI\u6d88\u606f\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5927\u4e8e0\uff1a\u5df2\u7ecf\u5904\u7406\u7684\u6d88\u606f\u4e2a\u6570\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u5c0f\u4e8e0\uff1a\u5931\u8d25\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"int i2c_master_recv(const struct i2c_client *client, char *buf, int count);\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u8fc7\u5c01\u88c5i2c_transfer()\u5b8c\u6210\u4e00\u6b21I2C\u63a5\u6536\u64cd\u4f5c\uff0c\u5373\u4eceI2C\u8bbe\u5907\u8bfb\u53d6\u6570\u636e\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"client"}),"\uff1a\u6307\u5411\u5f53\u524dTWI\u8bbe\u5907\u7684\u5b9e\u4f8b\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"buf"}),"\uff1a\u7528\u4e8e\u4fdd\u5b58\u63a5\u6536\u5230\u7684\u6570\u636e\u7684\u7f13\u5b58\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"count"}),"\uff1a\u6570\u636e\u7f13\u5b58buf\u7684\u957f\u5ea6\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\\\u5927\u4e8e0\uff1a\u6210\u529f\u63a5\u6536\u7684\u5b57\u8282\u6570\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u5c0f\u4e8e0\uff1a\u5931\u8d25\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"int i2c_master_send(const struct i2c_client *client, const char *buf, int count)\u3002\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u8fc7\u5c01\u88c5i2c_transfer()\u5b8c\u6210\u4e00\u6b21I2c\u53d1\u9001\u64cd\u4f5c\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"client"}),"\uff1a\u6307\u5411\u5f53\u524dTWI\u4ece\u8bbe\u5907\u7684\u5b9e\u4f8b\uff1b"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"buf"}),"\uff1a\u8981\u53d1\u9001\u7684\u6570\u636e\uff1b"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"count"}),"\uff1a\u8981\u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\\\u5927\u4e8e0\uff1a\u6210\u529f\u53d1\u9001\u7684\u5b57\u8282\u6570\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"\u5c0f\u4e8e0\uff1a\u5931\u8d25\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"i2c-\u7528\u6237\u6001\u63a5\u53e3",children:"I2C \u7528\u6237\u6001\u63a5\u53e3"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6253\u5f00\u8bbe\u5907\u6587\u4ef6"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u51fd\u6570\u539f\u578b"}),"\uff1a",(0,s.jsx)(e.code,{children:"int open(const char *pathname, int flags)"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"pathname"}),"\uff1a\u8981\u6253\u5f00\u7684\u8bbe\u5907\u6587\u4ef6\u7684\u8def\u5f84\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"flags"}),"\uff1a\u6253\u5f00\u6587\u4ef6\u7684\u6807\u5fd7\uff0c\u5982\u8bfb\u53d6\u3001\u5199\u5165\u3001\u8ffd\u52a0\u7b49\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u975e\u8d1f\u6574\u6570\uff09\uff0c\u7528\u4e8e\u540e\u7eed\u7684\u8bfb\u5199\u64cd\u4f5c\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u82e5\u5931\u8d25\uff0c\u5219\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u6765\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u5199\u5165\u6570\u636e"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u51fd\u6570\u539f\u578b"}),"\uff1a",(0,s.jsx)(e.code,{children:"ssize_t write(int fd, const void *buf, size_t count)"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"fd"}),"\uff1a\u5df2\u6253\u5f00\u7684I2C\u8bbe\u5907\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"buf"}),"\uff1a\u8981\u5199\u5165\u7684\u6570\u636e\u7684\u7f13\u51b2\u533a\u6307\u9488\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"count"}),"\uff1a\u8981\u5199\u5165\u7684\u6570\u636e\u7684\u5b57\u8282\u6570\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de\u5b9e\u9645\u6210\u529f\u5199\u5165\u7684\u5b57\u8282\u6570\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u82e5\u5931\u8d25\uff0c\u5219\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u6765\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8bfb\u53d6\u6570\u636e"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u51fd\u6570\u539f\u578b"}),"\uff1a",(0,s.jsx)(e.code,{children:"ssize_t read(int fd, void *buf, size_t count)"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"fd"}),"\uff1a\u5df2\u6253\u5f00\u7684I2C\u8bbe\u5907\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"buf"}),"\uff1a\u7528\u4e8e\u5b58\u50a8\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a\u6307\u9488\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"count"}),"\uff1a\u8981\u8bfb\u53d6\u7684\u6570\u636e\u7684\u6700\u5927\u5b57\u8282\u6570\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de\u5b9e\u9645\u6210\u529f\u8bfb\u53d6\u7684\u5b57\u8282\u6570\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u82e5\u5df2\u5230\u8fbe\u6587\u4ef6\u672b\u5c3e\uff0c\u5219\u8fd4\u56de0\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u82e5\u5931\u8d25\uff0c\u5219\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u6765\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u63a7\u5236\u64cd\u4f5c"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u51fd\u6570\u539f\u578b"}),"\uff1a",(0,s.jsx)(e.code,{children:"int ioctl(int fd, unsigned long request, ...)"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u6570"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"fd"}),"\uff1a\u5df2\u6253\u5f00\u7684I2C\u8bbe\u5907\u6587\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"request"}),"\uff1a\u63a7\u5236\u64cd\u4f5c\u7684\u8bf7\u6c42\u7801\uff0c\u7528\u4e8e\u6307\u5b9a\u8981\u6267\u884c\u7684\u64cd\u4f5c\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"..."}),"\uff1a\u53ef\u9009\u7684\u53c2\u6570\uff0c\u7528\u4e8e\u4f20\u9012\u63a7\u5236\u64cd\u4f5c\u6240\u9700\u7684\u5176\u4ed6\u4fe1\u606f\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de0\u6216\u8005\u6267\u884c\u64cd\u4f5c\u6240\u8fd4\u56de\u7684\u7279\u5b9a\u503c\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u82e5\u5931\u8d25\uff0c\u5219\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u6765\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u4f7f\u7528\u8303\u4f8b",children:"\u4f7f\u7528\u8303\u4f8b"}),"\n",(0,s.jsx)(e.h3,{id:"\u5185\u6838\u6001",children:"\u5185\u6838\u6001"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'#include <linux/init.h>\r\n#include <linux/module.h>\r\n#include <linux/i2c.h>\r\n\r\nstatic struct i2c_client *client;\r\n\r\nstatic int __init i2c_example_init(void)\r\n{\r\n    struct i2c_adapter *adapter;\r\n    struct i2c_board_info board_info;\r\n    struct i2c_client *new_client;\r\n\r\n    printk(KERN_INFO "I2C Example: Initializing\\n");\r\n\r\n    // \u83b7\u53d6\u7b2c\u4e00\u4e2a I2C \u603b\u7ebf\u9002\u914d\u5668\r\n    adapter = i2c_get_adapter(0);\r\n    if (!adapter) {\r\n        printk(KERN_ERR "I2C Example: Failed to get adapter\\n");\r\n        return -ENODEV;\r\n    }\r\n\r\n    // \u586b\u5145 I2C \u8bbe\u5907\u4fe1\u606f\r\n    memset(&board_info, 0, sizeof(board_info));\r\n    strlcpy(board_info.type, "example_device", I2C_NAME_SIZE);\r\n\r\n    // \u5728 I2C \u603b\u7ebf\u4e0a\u6ce8\u518c\u65b0\u7684\u8bbe\u5907\r\n    new_client = i2c_new_device(adapter, &board_info);\r\n    if (!new_client) {\r\n        printk(KERN_ERR "I2C Example: Failed to register device\\n");\r\n        i2c_put_adapter(adapter);\r\n        return -ENODEV;\r\n    }\r\n\r\n    client = new_client;\r\n\r\n    // \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u5bf9\u8bbe\u5907\u7684\u64cd\u4f5c\uff0c\u5982\u8bfb\u5199\u5bc4\u5b58\u5668\u7b49\r\n\r\n    return 0;\r\n}\r\n\r\nstatic void __exit i2c_example_exit(void)\r\n{\r\n    printk(KERN_INFO "I2C Example: Exiting\\n");\r\n\r\n    if (client) {\r\n        // \u4ece\u603b\u7ebf\u4e0a\u6ce8\u9500\u8bbe\u5907\r\n        i2c_unregister_device(client);\r\n    }\r\n}\r\n\r\nmodule_init(i2c_example_init);\r\nmodule_exit(i2c_example_exit);\r\n\r\nMODULE_LICENSE("GPL");\r\nMODULE_AUTHOR("Your Name");\r\nMODULE_DESCRIPTION("I2C Example Module");\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u7528\u6237\u6001",children:"\u7528\u6237\u6001"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'#include <sys/ioctl.h>\r\n#include <fcntl.h>\r\n#include <linux/i2c-dev.h>\r\n#include <linux/i2c.h>\r\n\r\n#define CHIP "/dev/i2c-1"\r\n#define CHIP_ADDR 0x50\r\n\r\nint main()\r\n{\r\n    unsigned char rddata;\r\n    unsigned char rdaddr[2] = {0, 0}; /* \u5c06\u8981\u8bfb\u53d6\u7684\u6570\u636e\u5728\u82af\u7247\u4e2d\u7684\u504f\u79fb\u91cf */\r\n    unsigned char wrbuf[3] = {0, 0, 0x3c}; /* \u8981\u5199\u7684\u6570\u636e\uff0c\u5934\u4e24\u5b57\u8282\u4e3a\u504f\u79fb\u91cf */\r\n    int fd = open(CHIP, O_RDWR);\r\n    if (fd < 0)\r\n    {\r\n        printf("open "CHIP"failed\\n");\r\n        goto exit;\r\n    }\r\n    if (ioctl(fd, TWI_SLAVE_FORCE, CHIP_ADDR) < 0)\r\n    { /* \u8bbe\u7f6e\u82af\u7247\u5730\u5740 */\r\n        printf("oictl:set slave address failed\\n");\r\n        goto close;\r\n    }\r\n    printf("input a char you want to write to E2PROM\\n");\r\n    wrbuf[2] = getchar();\r\n    printf("write return:%d, write data:%x\\n", write(fd, wrbuf, 3), wrbuf[2]);\r\n    sleep(1);\r\n    printf("write address return: %d\\n",write(fd, rdaddr, 2)); /* \u8bfb\u53d6\u4e4b\u524d\u9996\u5148\u8bbe\u7f6e\u8bfb\u53d6\u7684\u504f\u79fb\u91cf */\r\n    printf("read data return:%d\\n", read(fd, &rddata, 1));\r\n    printf("rddata: %c\\n", rddata);\r\n    close(fd);\r\n    exit:\r\n    return 0;\r\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(e.h3,{id:"twi\u6570\u636e\u672a\u5b8c\u5168\u53d1\u9001",children:"TWI\u6570\u636e\u672a\u5b8c\u5168\u53d1\u9001"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u73b0\u8c61"}),"\uff1a incomplete xfer\u3002\u5177\u4f53\u7684log\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"[ 1658.926643] sunxi_twi_do_xfer()1936 - [twi0] incomplete xfer (status: 0x20, dev addr: 0x50)\r\n[ 1658.926643] sunxi_twi_do_xfer()1936 - [twi0] incomplete xfer (status: 0x48, dev addr: 0x50)\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u5206\u6790"}),"\uff1a\u6b64\u9519\u8bef\u8868\u793a\u4e3b\u63a7\u5df2\u7ecf\u53d1\u9001\u4e86\u6570\u636e\uff08status\u503c\u4e3a0x20\u65f6\uff0c\u8868\u793a\u53d1\u9001\u4e86SLAVE ADDR + WRITE\uff1bstatus\u503c\u4e3a0x48\u65f6\uff0c\u8868\u793a\u53d1\u9001\u4e86SLAVE ADDR + READ\uff09\uff0c\u4f46\u662f\u8bbe\u5907\u6ca1\u6709\u56deACK\uff0c\u8fd9\u8868\u660e\u8bbe\u5907\u65e0\u54cd\u5e94\uff0c\u5e94\u8be5\u68c0\u67e5\u662f\u5426\u672a\u63a5\u8bbe\u5907\u3001\u63a5\u89e6\u4e0d\u826f\u3001\u8bbe\u5907\u635f\u574f\u548c\u4e0a\u7535\u65f6\u5e8f\u4e0d\u6b63\u786e\u5bfc\u81f4\u7684\u8bbe\u5907\u672a\u5c31\u7eea\u7b49\u95ee\u9898\u3002"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u6392\u67e5\u6b65\u9aa4"}),"\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa41\uff1a\u901a\u8fc7\u8bbe\u5907\u6811\u91cc\u9762\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u6838\u5bf9\u5f15\u811a\u914d\u7f6e\u662f\u5426\u6b63\u786e\u3002\u6bcf\u7ec4TWI\u90fd\u6709\u597d\u51e0\u7ec4\u5f15\u811a\u914d\u7f6e\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa42\uff1a\u66f4\u6362TWI\u603b\u7ebf\u4e0b\u7684\u8bbe\u5907\u4e3aat24c16\uff0c\u7528i2ctools\u8bfb\u5199at24c16\u770b\u770b\u662f\u5426\u6210\u529f\uff0c\u6210\u529f\u5219\u8868\u660e\u603b\u7ebf\u5de5\u4f5c\u6b63\u5e38\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa43\uff1a\u6392\u67e5\u8bbe\u5907\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u4ee5\u53ca\u8bbe\u5907\u4e0eTWI\u4e4b\u95f4\u7684\u786c\u4ef6\u63a5\u53e3\u662f\u5426\u5b8c\u597d\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa44\uff1a\u8be6\u7ec6\u4e86\u89e3\u5f53\u524d\u9700\u8981\u64cd\u4f5c\u7684\u8bbe\u5907\u7684\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u5de5\u4f5c\u65f6\u5e8f\uff0c\u4f7f\u7528\u65b9\u6cd5\uff0c\u6392\u67e5\u56e0\u521d\u59cb\u5316\u8bbe\u5907\u4e0d\u6b63\u786e\u5bfc\u81f4\u901a\u8baf\u5931\u8d25\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa45\uff1a\u7528\u793a\u6ce2\u5668\u68c0\u67e5TWI\u5f15\u811a\u8f93\u51fa\u6ce2\u5f62\uff0c\u67e5\u770b\u6ce2\u5f62\u662f\u5426\u5339\u914d\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"twi\u8d77\u59cb\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",children:"TWI\u8d77\u59cb\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u73b0\u8c61"}),"\uff1a START can't sendout!\u3002\u5177\u4f53\u7684log\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"sunxi_twi_do_xfer()1865 - [twi1] START can't sendout!\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u5206\u6790"}),"\uff1a\u6b64\u9519\u8bef\u8868\u793aTWI\u65e0\u6cd5\u53d1\u9001\u8d77\u59cb\u4fe1\u53f7\uff0c\u4e00\u822c\u8ddfTWI\u603b\u7ebf\u7684\u5f15\u811a\u914d\u7f6e\u4ee5\u53ca\u65f6\u949f\u914d\u7f6e\u6709\u5173\u3002\u5e94\u8be5\u68c0\u67e5\u5f15\u811a\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u65f6\u949f\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5f15\u811a\u662f\u5426\u5b58\u5728\u4e0a\u62c9\u7535\u963b\u7b49\u7b49\u3002"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u6392\u67e5\u6b65\u9aa4"}),"\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa41\uff1a\u91cd\u65b0\u542f\u52a8\u5185\u6838\uff0c\u901a\u8fc7\u67e5\u770blog\uff0c\u5206\u6790TWI\u662f\u5426\u6210\u529f\u521d\u59cb\u5316\uff0c\u5982\u82e5\u5b58\u5728\u5f15\u811a\u914d\u7f6e\u95ee\u9898\uff0c\u5e94\u6838\u5bf9\u5f15\u811a\u4fe1\u606f\u662f\u5426\u6b63\u786e\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa42\uff1a\u6839\u636e\u539f\u7406\u56fe\uff0c\u67e5\u770bTWI-SCK\u548cTWI-SDA\u662f\u5426\u7ecf\u8fc7\u5408\u9002\u7684\u4e0a\u62c9\u7535\u963b\u63a5\u52303.3v\u7535\u538b\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa43\uff1a\u7528\u4e07\u7528\u8868\u91cfSDA\u4e0eSCL\u521d\u59cb\u7535\u538b\uff0c\u770b\u7535\u538b\u662f\u5426\u57283.3V\u9644\u8fd1\uff08\u65ad\u5f00\u6b64TWI\u63a7\u5236\u5668\u6240\u6709\u5916\u8bbe\u786c\u4ef6\u8fde\u63a5\u4e0e\u8f6f\u4ef6\u901a\u8baf\u8fdb\u7a0b\uff09\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa44\uff1a\u6838\u67e5\u5f15\u811a\u914d\u7f6e\u4ee5\u53caclk\u914d\u7f6e\u662f\u5426\u8fdb\u884c\u6b63\u786e\u8bbe\u7f6e\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa45\uff1a \u6d4b\u8bd5PIN\u7684\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff0c\u5229\u7528\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u65b9\u5f0f\uff0c\u5c06PIN\u529f\u80fd\u76f4\u63a5\u8bbe\u4e3aINPUT\u529f\u80fd\uff0c\u7136\u540e\u5c06PIN\u4e0a\u62c9\u548c\u63a5\u5730\u6539\u53d8PIN\u72b6\u6001\uff0c\u8bfbPIN\u7684\u72b6\u6001\uff0c\u770b\u662f\u5426\u5339\u914d\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa46\uff1a\u6d4b\u8bd5CLK\u7684\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff0c\u5229\u7528\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u65b9\u5f0f\uff0c\u5c06TWI\u7684CLK gating\u7b49\u6253\u5f00\uff0c\uff0c\u7136\u540e\u8bfb\u53d6\u76f8\u5e94TWI\u7684\u5bc4\u5b58\u5668\u4fe1\u606f\uff0c\u8bfbTWI\u5bc4\u5b58\u5668\u7684\u6570\u636e\uff0c\u67e5\u770b\u5bc4\u5b58\u5668\u6570\u636e\u662f\u5426\u6b63\u5e38\uff1b"}),"\n",(0,s.jsx)(e.h3,{id:"twi\u7ec8\u6b62\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001",children:"TWI\u7ec8\u6b62\u4fe1\u53f7\u65e0\u6cd5\u53d1\u9001"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u73b0\u8c61"}),"\uff1a STOP can't sendout\u3002\u5177\u4f53\u7684log\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"twi_stop()511 - [twi4] STOP can't sendout!\r\nsunxi_twi_core_process()1726 - [twi4] STOP failed!\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u5206\u6790"}),"\uff1a\u6b64\u9519\u8bef\u8868\u793aTWI\u65e0\u6cd5\u53d1\u9001\u7ec8\u6b62\u4fe1\u53f7\uff0c\u4e00\u822c\u8ddfTWI\u603b\u7ebf\u7684\u5f15\u811a\u914d\u7f6e\u3002\u5e94\u8be5\u68c0\u67e5\u5f15\u811a\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff0c\u5f15\u811a\u7535\u538b\u662f\u5426\u7a33\u5b9a\u7b49\u7b49\u3002"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u6392\u67e5\u6b65\u9aa4"}),"\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa41\uff1a\u6839\u636e\u539f\u7406\u56fe\uff0c\u67e5\u770bTWI-SCK\u548cTWI-SDA\u662f\u5426\u7ecf\u8fc7\u5408\u9002\u7684\u4e0a\u62c9\u7535\u963b\u63a5\u52303.3v\u7535\u538b\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa42\uff1a\u7528\u4e07\u7528\u8868\u91cfSDA\u4e0eSCL\u521d\u59cb\u7535\u538b\uff0c\u770b\u7535\u538b\u662f\u5426\u57283.3V\u9644\u8fd1\uff08\u65ad\u5f00\u6b64TWI\u63a7\u5236\u5668\u6240\u6709\u5916\u8bbe\u786c\u4ef6\u8fde\u63a5\u4e0e\u8f6f\u4ef6\u901a\u8baf\u8fdb\u7a0b\uff09\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa43\uff1a \u6d4b\u8bd5PIN\u7684\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff0c\u5229\u7528\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u65b9\u5f0f\uff0c\u5c06PIN\u529f\u80fd\u76f4\u63a5\u8bbe\u4e3aINPUT\u529f\u80fd\uff0c\u7136\u540e\u5c06PIN\u4e0a\u62c9\u548c\u63a5\u5730\u6539\u53d8PIN\u72b6\u6001\uff0c\u8bfbPIN\u7684\u72b6\u6001\uff0c\u770b\u662f\u5426\u5339\u914d\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa44: \u67e5\u770b\u8bbe\u5907\u6811\u914d\u7f6e\uff0c\u628a\u5176\u4ed6\u7528\u5230SCK/SDA\u5f15\u811a\u7684\u8282\u70b9\u5173\u95ed\uff0c\u91cd\u65b0\u6d4b\u8bd5TWI\u901a\u4fe1\u529f\u80fd\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"twi\u4f20\u9001\u8d85\u65f6",children:"TWI\u4f20\u9001\u8d85\u65f6"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u73b0\u8c61"}),"\uff1a xfer timeout\u3002\u5177\u4f53\u7684log\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:"[123.681219] sunxi_twi_do_xfer()1914 - [twi3] xfer timeout (dev addr:0x50)\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u5206\u6790"}),":\u6b64\u9519\u8bef\u8868\u793a\u4e3b\u63a7\u5df2\u7ecf\u53d1\u9001\u5b8c\u8d77\u59cb\u4fe1\u53f7\uff0c\u4f46\u662f\u5728\u4e0e\u8bbe\u5907\u901a\u4fe1\u7684\u8fc7\u7a0b\u4e2d\u65e0\u6cd5\u6b63\u5e38\u5b8c\u6210\u6570\u636e\u53d1\u9001\u4e0e\u63a5\u6536\uff0c\u5bfc\u81f4\u6700\u7ec8\u6ca1\u6709\u53d1\u51fa\u7ec8\u6b62\u4fe1\u53f7\u6765\u7ed3\u675fTWI\u4f20\u8f93\uff0c\u5bfc\u81f4\u7684\u4f20\u8f93\u8d85\u65f6\u95ee\u9898\u3002\u5e94\u8be5\u68c0\u67e5\u5f15\u811a\u914d\u7f6e\u662f\u5426\u6b63\u5e38\uff0cCLK\u914d\u7f6e\u662f\u5426\u6b63\u5e38\uff0cTWI\u5bc4\u5b58\u5668\u6570\u636e\u662f\u5426\u6b63\u5e38\uff0c\u662f\u5426\u6709\u5176\u4ed6\u8bbe\u5907\u5e72\u6270\uff0c\u4e2d\u65ad\u662f\u5426\u6b63\u5e38\u7b49\u95ee\u9898\u3002"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u95ee\u9898\u6392\u67e5\u6b65\u9aa4"}),"\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa41\uff1a\u6838\u5b9eTWI\u63a7\u5236\u5668\u914d\u7f6e\u662f\u5426\u6b63\u786e\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa42\uff1a\u6839\u636e\u539f\u7406\u56fe\uff0c\u67e5\u770bTWI-SCK\u548cTWI-SDA\u662f\u5426\u7ecf\u8fc7\u5408\u9002\u7684\u4e0a\u62c9\u7535\u963b\u63a5\u52303.3v\u7535\u538b\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa43\uff1a\u7528\u4e07\u7528\u8868\u91cfSDA\u4e0eSCL\u521d\u59cb\u7535\u538b\uff0c\u770b\u7535\u538b\u662f\u5426\u57283.3V\u9644\u8fd1\uff08\u65ad\u5f00\u6b64TWI\u63a7\u5236\u5668\u6240\u6709\u5916\u8bbe\u786c\u4ef6\u8fde\u63a5\u4e0e\u8f6f\u4ef6\u901a\u8baf\u8fdb\u7a0b\uff09\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa44\uff1a\u5173\u95ed\u5176\u4ed6TWI\u8bbe\u5907\uff0c\u91cd\u65b0\u8fdb\u884c\u70e7\u5f55\u6d4b\u8bd5TWI\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa45\uff1a \u6d4b\u8bd5PIN\u7684\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff0c\u5229\u7528\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u65b9\u5f0f\uff0c\u5c06PIN\u529f\u80fd\u76f4\u63a5\u8bbe\u4e3aINPUT\u529f\u80fd\uff0c\u7136\u540e\u5c06PIN\u4e0a\u62c9\u548c\u63a5\u5730\u6539\u53d8PIN\u72b6\u6001\uff0c\u8bfbPIN\u7684\u72b6\u6001\uff0c\u770b\u662f\u5426\u5339\u914d\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa46\uff1a\u6d4b\u8bd5CLK\u7684\u529f\u80fd\u662f\u5426\u6b63\u5e38\uff0c\u5229\u7528\u5bc4\u5b58\u5668\u8bfb\u5199\u7684\u65b9\u5f0f\uff0c\u5c06TWI\u7684CLK gating\u7b49\u6253\u5f00\uff0c\uff0c\u7136\u540e\u8bfb\u53d6\u76f8\u5e94TWI\u7684\u5bc4\u5b58\u5668\u4fe1\u606f\uff0c\u8bfbTWI\u5bc4\u5b58\u5668\u7684\u6570\u636e\uff0c\u67e5\u770b\u5bc4\u5b58\u5668\u6570\u636e\u662f\u5426\u6b63\u5e38\uff1b"}),"\n",(0,s.jsx)(e.p,{children:"\u6b65\u9aa47\uff1a\u6839\u636e\u76f8\u5173\u7684LOG\u8ddf\u8e2aTWI\u4ee3\u7801\u6267\u884c\u6d41\u7a0b\uff0c\u5206\u6790\u62a5\u9519\u539f\u56e0\u3002"})]})}function j(n={}){const{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},46992:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20240514121248384-ed33cb1488e00db055fb71ca492b2030.png"},10015:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20240514124616982-53e7fe307771b87d701d31d73e108873.png"},2436:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20240514124918500-f02e27339eb66ab6c4633cbd6d8c9542.png"},77338:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20240514124939886-9067cac6f5f54fa936bd22d0c8eab32f.png"},34664:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20240514125043775-46b82685b362ada33dc136326c54d797.png"},11151:(n,e,i)=>{i.d(e,{Z:()=>c,a:()=>d});var s=i(67294);const r={},l=s.createContext(r);function d(n){const e=s.useContext(l);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),s.createElement(l.Provider,{value:e},n.children)}}}]);