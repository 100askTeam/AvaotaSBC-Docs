"use strict";(self.webpackChunkavaota_docs=self.webpackChunkavaota_docs||[]).push([[6560],{84106:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>x});var i=r(85893),s=r(11151);const l={},d="IR RX - \u7ea2\u5916\u63a5\u6536",t={id:"linux-manual/sdk-develop/bsp-driver/ir-rx",title:"IR RX - \u7ea2\u5916\u63a5\u6536",description:"\u7ea2\u5916\u9065\u63a7\u7684\u53d1\u5c04\u7535\u8def\u662f\u91c7\u7528\u7ea2\u5916\u53d1\u5149\u4e8c\u6781\u7ba1\u6765\u53d1\u51fa\u7ecf\u8fc7\u8c03\u5236\u7684\u7ea2\u5916\u5149\u6ce2\uff1b\u7ea2\u5916\u63a5\u6536\u7535\u8def\u7531\u7ea2\u5916\u63a5\u6536\u4e8c\u6781\u7ba1\u3001\u4e09\u6781\u7ba1\u6216\u7845\u5149\u7535\u6c60\u7ec4\u6210\uff0c\u5b83\u4eec\u5c06\u7ea2\u5916\u53d1\u5c04\u5668\u53d1\u5c04\u7684\u7ea2\u5916\u5149\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684\u7535\u4fe1\u53f7\uff0c\u518d\u9001\u540e\u7f6e\u653e\u5927\u5668\u3002",source:"@site/docs/linux-manual/sdk-develop/bsp-driver/ir-rx.md",sourceDirName:"linux-manual/sdk-develop/bsp-driver",slug:"/linux-manual/sdk-develop/bsp-driver/ir-rx",permalink:"/linux-manual/sdk-develop/bsp-driver/ir-rx",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"linuxManualSidebar",previous:{title:"HWSPINLOCK - \u786c\u4ef6\u81ea\u65cb\u9501",permalink:"/linux-manual/sdk-develop/bsp-driver/hwspinlock"},next:{title:"IR TX - \u7ea2\u5916\u53d1\u5c04",permalink:"/linux-manual/sdk-develop/bsp-driver/ir-tx"}},c={},x=[{value:"\u7535\u8def\u539f\u7406\u56fe",id:"\u7535\u8def\u539f\u7406\u56fe",level:2},{value:"\u6a21\u5757\u914d\u7f6e",id:"\u6a21\u5757\u914d\u7f6e",level:2},{value:"\u9a71\u52a8\u914d\u7f6e",id:"\u9a71\u52a8\u914d\u7f6e",level:3},{value:"\u8bbe\u5907\u6811\u914d\u7f6e",id:"\u8bbe\u5907\u6811\u914d\u7f6e",level:3},{value:"\u9a71\u52a8\u63a5\u53e3",id:"\u9a71\u52a8\u63a5\u53e3",level:2},{value:"sunxi_irrx_probe",id:"sunxi_irrx_probe",level:3},{value:"sunxi_irrx_reg_cfg",id:"sunxi_irrx_reg_cfg",level:3},{value:"irqreturn_t sunxi_irrx_irq",id:"irqreturn_t-sunxi_irrx_irq",level:3},{value:"sunxi_irrx_recv",id:"sunxi_irrx_recv",level:3},{value:"evdev_read()",id:"evdev_read",level:3},{value:"evdev_write()",id:"evdev_write",level:3},{value:"evdev_ioctl()",id:"evdev_ioctl",level:3},{value:"\u6a21\u5757 DEMO",id:"\u6a21\u5757-demo",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"ir-rx---\u7ea2\u5916\u63a5\u6536",children:"IR RX - \u7ea2\u5916\u63a5\u6536"}),"\n",(0,i.jsx)(n.p,{children:"\u7ea2\u5916\u9065\u63a7\u7684\u53d1\u5c04\u7535\u8def\u662f\u91c7\u7528\u7ea2\u5916\u53d1\u5149\u4e8c\u6781\u7ba1\u6765\u53d1\u51fa\u7ecf\u8fc7\u8c03\u5236\u7684\u7ea2\u5916\u5149\u6ce2\uff1b\u7ea2\u5916\u63a5\u6536\u7535\u8def\u7531\u7ea2\u5916\u63a5\u6536\u4e8c\u6781\u7ba1\u3001\u4e09\u6781\u7ba1\u6216\u7845\u5149\u7535\u6c60\u7ec4\u6210\uff0c\u5b83\u4eec\u5c06\u7ea2\u5916\u53d1\u5c04\u5668\u53d1\u5c04\u7684\u7ea2\u5916\u5149\u8f6c\u6362\u4e3a\u76f8\u5e94\u7684\u7535\u4fe1\u53f7\uff0c\u518d\u9001\u540e\u7f6e\u653e\u5927\u5668\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u9274\u4e8e\u5bb6\u7528\u7535\u5668\u7684\u54c1\u79cd\u591a\u6837\u5316\u548c\u7528\u6237\u7684\u4f7f\u7528\u7279\u70b9\uff0c\u751f\u4ea7\u5382\u5bb6\u5bf9\u8fdb\u884c\u4e86\u4e25\u683c\u7684\u89c4\u8303\u7f16\u7801\uff0c\u8fd9\u4e9b\u7f16\u7801 \u5404\u4e0d\u76f8\u540c\uff0c\u4ece\u800c\u5f62\u6210\u4e0d\u540c\u7684\u7f16\u7801\u65b9\u5f0f\uff0c\u7edf\u4e00\u79f0\u4e3a\u7ea2\u5916\u9065\u63a7\u5668\u7f16\u7801\u4f20\u8f93\u534f\u8bae\u3002\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u7ea2\u5916\u9065\u63a7 \u534f\u8bae\u5df2\u591a\u8fbe\u5341\u79cd\uff0c \u5982\uff1aRC5\u3001SIRCS\u3001Sy\u3001RECS80\u3001Denon\u3001NEC\u3001Motorola\u3001Japanese\u3001 SAMSWNG \u548c Daewoo \u7b49\u3002\u6211\u56fd\u5bb6\u7528\u7535\u5668\u7684\u7ea2\u5916\u9065\u63a7\u5668\u7684\u751f\u4ea7\u5382\u5bb6\uff0c\u5176\u7f16\u7801\u65b9\u5f0f\u591a\u6570\u662f\u6309\u4e0a\u8ff0 \u7684\u5404\u79cd\u534f\u8bae\u8fdb\u884c\u7f16\u7801\u7684\uff0c\u800c\u7528\u5f97\u8f83\u591a\u7684\u6709 NEC \u534f\u8bae\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u7535\u8def\u539f\u7406\u56fe",children:"\u7535\u8def\u539f\u7406\u56fe"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240401150914945",src:r(12688).Z+"",width:"571",height:"228"})}),"\n",(0,i.jsx)(n.p,{children:"IR-RX\u63a5\u5230\u4e3b\u63a7\u7684IR-RX\u6a21\u5757\u7684\u63a5\u6536\u7ba1\u811a\u3002\u5f53IR\u63a5\u6536\u5230\u6570\u636e\u540e\uff0c\u4f1a\u4ea7\u751f\u4e2d\u65ad\uff0c\u8f6f\u4ef6\u6536\u5230\u4e2d\u65ad\u4f1a\u8fdb\u884c\u6570\u636e\u8bfb\u53d6\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u5757\u914d\u7f6e",children:"\u6a21\u5757\u914d\u7f6e"}),"\n",(0,i.jsx)(n.h3,{id:"\u9a71\u52a8\u914d\u7f6e",children:"\u9a71\u52a8\u914d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"IR-RX Drivers ->\r\n\t<*> IR-RX Support for Allwinner SoCs\r\n\t< > Allwinner GPIO IR remote control\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20240401232402738",src:r(94265).Z+"",width:"1084",height:"291"})}),"\n",(0,i.jsx)(n.h3,{id:"\u8bbe\u5907\u6811\u914d\u7f6e",children:"\u8bbe\u5907\u6811\u914d\u7f6e"}),"\n",(0,i.jsxs)(n.p,{children:["\u8bbe\u5907\u6811 ",(0,i.jsx)(n.code,{children:"dtsi"})," \u4e2d\u5b58\u5728\u7684\u662f\u8be5\u7c7b\u82af\u7247\u6240\u6709\u5e73\u53f0\u7684\u6a21\u5757\u914d\u7f6e\uff0cIR-RX \u7684\u8bbe\u5907\u6811\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'s_cir0: s_cir@7040000 {\r\n\tcompatible = "allwinner,s_cir";\t\t\t\t\t// \u5177\u4f53\u7684\u8bbe\u5907\uff0c\u7528\u4e8e\u9a71\u52a8\u548c\u8bbe\u5907\u7684\u7ed1\u5b9a\r\n\treg = <0x0 0x07040000 0x0 0x400>;\t\t\t\t// \u8bbe\u5907\u4f7f\u7528\u7684\u5730\u5740\r\n\tinterrupts = <GIC_SPI 151 IRQ_TYPE_LEVEL_HIGH>;\t// \u8bbe\u5907\u4f7f\u7528\u7684\u4e2d\u65ad\r\n\tclocks = <&r_ccu CLK_R_APB0_BUS_IRRX>, <&dcxo24M>, <&r_ccu CLK_R_APB0_IRRX>;\t// \u8bbe\u5907\u4f7f\u7528\u7684\u65f6\u949f\r\n\tclock-names = "bus", "pclk", "mclk";\t\t\t\t\t\t\t\t\t\t\t// \u4f7f\u7528\u7684\u65f6\u949f\u540d\r\n\tresets = <&r_ccu RST_R_APB0_BUS_IRRX>;\t\t\t// \u8bbe\u5907\u4f7f\u7528\u7684\u590d\u4f4d\u65f6\u949f\r\n\tstatus = "disabled";\t\t\t\t\t\t\t// \u8bbe\u5907\u662f\u5426\u4f7f\u7528\uff0cdtsi\u4e2d\u8bbe\u4e3adisabled\uff0c\u4f1a\u88abboard.dts\u4e2d\u7684\u914d\u7f6e\u8986\u76d6\r\n};\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5f15\u811a\u914d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'&pio {\r\n\ts_cir0_pins_a: s_cir0@0 {\r\n\t\tpins = "PB1";\t\t\t\t\t\t\t\t// \u4f7f\u7528\u7684\u5f15\u811a,\u4e0d\u540c\u82af\u7247\u4e0d\u4e00\u6837\r\n\t\tfunction = "ir";\r\n\t};\r\n\r\n\ts_cir0_pins_b: s_cir0@1 {\r\n\t\tpins = "PB1";\r\n\t\tfunction = "gpio_in";\r\n\t};\r\n};\n'})}),"\n",(0,i.jsx)(n.p,{children:"IR \u914d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'&s_cir0 {\r\n\t\tpinctrl-names = "default", "sleep";\t\t// \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u540d\u79f0\r\n\t\tpinctrl-0 = <&s_cir0_pins_a>;\t\t\t// \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08default\uff09\r\n\t\tpinctrl-1 = <&s_cir0_pins_b>;\t\t\t// \u8bbe\u5907\u4f7f\u7528\u7684pin\u811a\u914d\u7f6e\uff08sleep\uff09\r\n\t\tstatus = "okay";\t\t\t\t\t\t// \u8bbe\u5907\u662f\u5426\u4f7f\u7528\r\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u9a71\u52a8\u63a5\u53e3",children:"\u9a71\u52a8\u63a5\u53e3"}),"\n",(0,i.jsx)(n.h3,{id:"sunxi_irrx_probe",children:"sunxi_irrx_probe"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static int sunxi_irrx_probe(struct platform_device *pdev)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\uff1a"})," \u521d\u59cb\u5316IR RX\u6a21\u5757\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})," ",(0,i.jsx)(n.code,{children:"pdev"}),"\uff1a\u8bbe\u5907\u7ed3\u6784\u4f53\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de\u9519\u8bef\u7801\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sunxi_irrx_reg_cfg",children:"sunxi_irrx_reg_cfg"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static void sunxi_irrx_reg_cfg(void __iomem *reg_base)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\uff1a"})," irrx\u5bc4\u5b58\u5668\u914d\u7f6e\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})," ",(0,i.jsx)(n.code,{children:"reg_base"}),"\uff1airrx\u7684\u57fa\u5730\u5740\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u65e0\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"irqreturn_t-sunxi_irrx_irq",children:"irqreturn_t sunxi_irrx_irq"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static irqreturn_t sunxi_irrx_irq(int irq, void *dev_id)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\uff1a"})," \u4e2d\u65ad\u670d\u52a1\u51fd\u6570\uff0c\u8bfb\u53d6FIFO\u6570\u636e\uff0c\u5e76\u89e3\u7801\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})," ",(0,i.jsx)(n.code,{children:"irqno"}),"\uff1a\u4e2d\u65ad\u53f7\uff1b",(0,i.jsx)(n.code,{children:"dev_id"}),"\uff1a\u4fdd\u5b58IR RX\u6570\u636e\u7ed3\u6784\u4f53\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u8fd4\u56deIRQ_HANDLED\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sunxi_irrx_recv",children:"sunxi_irrx_recv"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static void sunxi_irrx_recv(u32 reg_data, struct sunxi_ir_rx *chip)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\uff1a"})," \u5c06\u63a5\u6536\u7684ir\u6570\u636e\u4e0a\u62a5\u81f3input\u5b50\u7cfb\u7edf\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})," ",(0,i.jsx)(n.code,{children:"reg_data"}),"\uff1aFIFO\u5bc4\u5b58\u5668\u4e2d\u7684\u6570\u636e\uff1b",(0,i.jsx)(n.code,{children:"chip"}),"\uff1airrx\u6570\u636e\u7ed3\u6784\u4f53\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u65e0\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["IR-RX\u6a21\u5757\u5728Linux\u5185\u6838\u4e2d\u662f\u4f5c\u4e3a\u5b57\u7b26\u8bbe\u5907\u4f7f\u7528\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u76f8\u5173\u5b57\u7b26\u8bbe\u5907\u63a5\u53e3\u6765\u5bf9IR-RX\u6a21\u5757\u8fdb\u884c\u76f8\u5e94\u7684\u8bfb\u5199\u548c\u914d\u7f6e\u64cd\u4f5c\u3002\u76f8\u5173\u5b9a\u4e49\u5728 ",(0,i.jsx)(n.code,{children:"evdev.c"})," \u6587\u4ef6\u91cc\u9762\u3002\u4e0b\u9762\u4ecb\u7ecd\u51e0\u4e2a\u6bd4\u8f83\u6709\u7528\u7684\u51fd\u6570\uff1a"]}),"\n",(0,i.jsx)(n.p,{children:"**### evdev_open()"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static int evdev_open(struct inode *inode, struct file *file)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\u63cf\u8ff0\uff1a"})," \u8c03\u7528open(file)\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u7528\u4e8e\u6253\u5f00\u4e00\u4e2aIR-RX\u6a21\u5757\u8bbe\u5907\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"})," ",(0,i.jsx)(n.code,{children:"inode"}),"\uff1ainode\u8282\u70b9\uff1b",(0,i.jsx)(n.code,{children:"file"}),"\uff1afile\u7ed3\u6784\u4f53\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u6587\u4ef6\u63cf\u8ff0\u7b26\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"evdev_read",children:"evdev_read()"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static ssize_t evdev_read(struct file *file, char __user *buffer, size_t count, loff_t *ppos)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u529f\u80fd\u63cf\u8ff0\uff1a"})," \u8c03\u7528read()\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u7528\u4e8e\u8bfb\u53d6IR-RX\u6a21\u5757\u4e0a\u62a5\u7684\u4e8b\u4ef6\u6570\u636e\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"})," ",(0,i.jsx)(n.code,{children:"file"}),"\uff1afile\u7ed3\u6784\u4f53\uff1b",(0,i.jsx)(n.code,{children:"buffer"}),"\uff1a\u5199\u6570\u636e\u7f13\u51b2\u533a\uff1b",(0,i.jsx)(n.code,{children:"count"}),"\uff1a\u8bfb\u53d6\u5b57\u8282\u6570\uff1b",(0,i.jsx)(n.code,{children:"ppos"}),"\uff1a\u6587\u4ef6\u504f\u79fb\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u6210\u529f\u8fd4\u56de\u8bfb\u53d6\u7684\u5b57\u8282\u6570\uff0c\u5931\u8d25\u8fd4\u56de\u8d1f\u6570\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"evdev_write",children:"evdev_write()"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static ssize_t evdev_write(struct file *file, const char __user *buffer, size_t count, loff_t *ppos)"})]}),"\n",(0,i.jsx)(n.li,{children:"**\u529f\u80fd\u63cf\u8ff0\uff1a**\u8c03\u7528write()\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u7528\u4e8e\u5411IR-RX\u6a21\u5757\u5199\u5165\u4e0a\u62a5\u4e8b\u4ef6\u3002"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"})," ",(0,i.jsx)(n.code,{children:"file"}),"\uff1afile\u7ed3\u6784\u4f53\uff1b",(0,i.jsx)(n.code,{children:"buffer"}),"\uff1a\u8bfb\u6570\u636e\u7f13\u51b2\u533a\uff1b",(0,i.jsx)(n.code,{children:"count"}),"\uff1a\u5199\u5165\u5b57\u8282\u6570\uff1b",(0,i.jsx)(n.code,{children:"ppos"}),"\uff1a\u6587\u4ef6\u504f\u79fb\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de\u8d1f\u6570\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"evdev_ioctl",children:"evdev_ioctl()"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u51fd\u6570\u539f\u578b\uff1a"})," ",(0,i.jsx)(n.code,{children:"static long evdev_ioctl(struct file *file, unsigned int cmd, unsigned long arg)"})]}),"\n",(0,i.jsx)(n.li,{children:"**\u529f\u80fd\u63cf\u8ff0\uff1a**\u8c03\u7528ioctl()\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u7528\u4e8e\u7ba1\u7406\u76f8\u5173\u7684IR-RX\u6a21\u5757\u529f\u80fd\u3002"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"})," ",(0,i.jsx)(n.code,{children:"file"}),"\uff1afile\u7ed3\u6784\u4f53\uff1b",(0,i.jsx)(n.code,{children:"cmd"}),"\uff1a\u6307\u4ee4\uff1b",(0,i.jsx)(n.code,{children:"arg"}),"\uff1a\u5176\u4ed6\u53c2\u6570\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c\uff1a"})," \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de\u8d1f\u6570\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u627e\u5230IR-RX\u6a21\u5757\u5bf9\u5e94\u7684event\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528C\u8bed\u8a00\u7684\u6587\u4ef6\u8bfb\u5199\u548c\u63a7\u5236\u51fd\u6570\u6765\u8c03\u7528\u4e0a\u8ff0\u7684\u63a5\u53e3\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u5757-demo",children:"\u6a21\u5757 DEMO"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5047\u8bbeIR RX\u8f93\u5165\u8bbe\u5907\u7684\u4e8b\u4ef6\u6587\u4ef6\u662f",(0,i.jsx)(n.code,{children:"/dev/input/event0"}),"\uff0c\u5e76\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u5b83\u3002\u7136\u540e\uff0c\u6211\u4eec\u5faa\u73af\u8bfb\u53d6\u4e8b\u4ef6\u6570\u636e\uff0c\u5e76\u6253\u5370\u6bcf\u4e2a\u4e8b\u4ef6\u7684\u7c7b\u578b\u3001\u4ee3\u7801\u548c\u503c\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'#include <linux/input.h>\r\n#include <stdio.h>\r\n#include <fcntl.h>\r\n#include <unistd.h>\r\n#include <stdlib.h>\r\n\r\nint main() {\r\n    int fd;\r\n    struct input_event event;\r\n\r\n    // \u6253\u5f00\u865a\u62df\u8f93\u5165\u8bbe\u5907\u6587\u4ef6\uff08\u8fd9\u91cc\u4f7f\u7528\u6807\u51c6\u8f93\u5165\u8bbe\u5907stdin\u4f5c\u4e3a\u793a\u4f8b\uff09\r\n    fd = open("/dev/input/event0", O_RDONLY);\r\n    if (fd == -1) {\r\n        perror("open");\r\n        exit(1);\r\n    }\r\n\r\n    printf("Reading from the input device...\\n");\r\n\r\n    // \u5faa\u73af\u8bfb\u53d6\u4e8b\u4ef6\u6570\u636e\r\n    while (1) {\r\n        ssize_t bytes = read(fd, &event, sizeof(event));\r\n        if (bytes == -1) {\r\n            perror("read");\r\n            exit(1);\r\n        } else if (bytes != sizeof(event)) {\r\n            fprintf(stderr, "Incomplete event read\\n");\r\n            exit(1);\r\n        }\r\n\r\n        // \u6253\u5370\u4e8b\u4ef6\u7c7b\u578b\u548c\u503c\r\n        printf("Event type: %u, code: %u, value: %u\\n", event.type, event.code, event.value);\r\n    }\r\n\r\n    close(fd);\r\n\r\n    return 0;\r\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},12688:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/image-20240401150914945-0a17d082779eace782f5d54515e99b35.png"},94265:(e,n,r)=>{r.d(n,{Z:()=>i});const i=r.p+"assets/images/image-20240401232402738-2dafd1613101fa0ade712058d521beb7.png"},11151:(e,n,r)=>{r.d(n,{Z:()=>t,a:()=>d});var i=r(67294);const s={},l=i.createContext(s);function d(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);